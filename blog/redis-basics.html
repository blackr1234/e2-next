<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/blog/2022-07/redis-basics/redis-scan-command.png"/><link rel="stylesheet" href="/e2-next/_next/static/css/d3df112486f97f47.css" data-precedence="next"/><link rel="stylesheet" href="/e2-next/_next/static/css/c3624a693ae5a0c4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/e2-next/_next/static/chunks/webpack-f088da4552bcc253.js"/><script src="/e2-next/_next/static/chunks/4bd1b696-120f4d9c40d223dd.js" async=""></script><script src="/e2-next/_next/static/chunks/1517-c8d232d43a11224c.js" async=""></script><script src="/e2-next/_next/static/chunks/main-app-05c45cc8f30d6cea.js" async=""></script><script src="/e2-next/_next/static/chunks/7829-b7b9eb1dbe0d40e4.js" async=""></script><script src="/e2-next/_next/static/chunks/2153-45fd9844831c6348.js" async=""></script><script src="/e2-next/_next/static/chunks/app/layout-ea91c2d128ec48c2.js" async=""></script><script src="/e2-next/_next/static/chunks/app/page-c8b940db14fac9a0.js" async=""></script><title>Michael Chung&#x27;s e-Portfolio</title><meta name="description" content="Powered by Next.js and React"/><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"/><script src="/e2-next/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div class="vstack gap-5"><div class="text-center vstack gap-5"><div><code class="SiteHeader_name__cwQmL">Chung Cheuk Hang Michael</code><code class="SiteHeader_title__CCfvI">Java Web Developer</code></div><nav class="justify-content-center navbar navbar-expand-md navbar-dark"><button type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed"><span class="navbar-toggler-icon"></span></button><div class="justify-content-center navbar-collapse collapse"><div class="justify-content-center navbar-nav nav-underline"><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/" class="nav-link" href="/e2-next">Home</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/work" class="nav-link" href="/e2-next/work">Work</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/hobbyProjects" class="nav-link" href="/e2-next/hobbyProjects">Hobby projects</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/personality" class="nav-link" href="/e2-next/personality">Personality</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/blog" class="nav-link" href="/e2-next/blog">Blog</a></div></div></div></nav></div><h1>1 Redis 簡介</h1>
<p>關於 Redis 既基本簡介可以喺呢篇度搵到：<a href="/blog/spring-caching-redis#1-redis-%E7%B0%A1%E4%BB%8B">Spring 項目使用 Redis 做 caching - Redis 簡介</a>。</p>
<hr/>
<h1>2 基本概念</h1>
<p>Redis 有 <code>16</code> 個 databases（<code>0</code>-based，<code>0</code> 至 <code>15</code>），每個 database 裡面既數據都係以 key-value pair 既形式儲存。</p>
<p>Redis 既 data types 指既係 key-value pair 既 value 所用既儲存格式。</p>
<hr/>
<h1>3 本地運行</h1>
<p>關於點樣本地運行 Redis 可以喺呢篇度搵到：<a href="/blog/spring-caching-redis#2-%E5%AE%89%E8%A3%9D">Spring 項目使用 Redis 做 caching - 安裝</a>。</p>
<hr/>
<h1>4 Database 操作</h1>
<h2>4.1 選擇 database</h2>
<p>Redis CLI 成功連接之後，初始選擇既係 database <code>0</code>。</p>
<pre><code class="language-bash">SELECT &quot;&lt;database index, 0~15&gt;&quot;
</code></pre>
<hr/>
<h2>4.2 查詢目前 database 資料數量</h2>
<p>查詢目前所選擇既 database 既資料數量（key 數量）：</p>
<pre><code class="language-bash"># database size
DBSIZE
</code></pre>
<hr/>
<h2>4.3 刪除目前 database 內所有資料</h2>
<p>以下指令會刪除目前所選擇既 database 既所有資料：</p>
<pre><code class="language-bash"># flush database
FLUSHDB
</code></pre>
<hr/>
<h2>4.4 刪除所有資料</h2>
<p>以下指令會刪除所有 databases 既所有資料：</p>
<pre><code class="language-bash"># flush all
FLUSHALL
</code></pre>
<hr/>
<h1>5 查詢 keys</h1>
<h2>5.1 <code>KEYS</code></h2>
<p>查詢所有 keys：</p>
<pre><code class="language-bash">KEYS *
</code></pre>
<p>我地亦可以使用 glob-style 既 patterns 去查詢 keys，例如用 <code>*</code> 代表任意長度既任意值。</p>
<p>查詢以特定 prefix 開頭既 keys：</p>
<pre><code class="language-bash">KEYS &quot;&lt;key prefix&gt;*&quot;
</code></pre>
<hr/>
<h2>5.2 <code>SCAN</code></h2>
<p>根據 Redis 官網呢篇關於 <code>KEYS</code> 指令既文檔——<a href="https://redis.io/docs/latest/commands/keys/">KEYS pattern</a>，我地最好唔好喺 Production 環境用 <code>KEYS</code>：</p>
<blockquote>
<p><strong>Warning</strong>: consider <code>KEYS</code> as a command that should only be used in production environments with extreme care. It may ruin performance when it is executed against large databases. This command is intended for debugging and special operations, such as changing your keyspace layout. Don&#x27;t use <code>KEYS</code> in your regular application code. If you&#x27;re looking for a way to find keys in a subset of your keyspace, consider using <a href="https://redis.io/commands/scan"><code>SCAN</code></a> or <a href="https://redis.io/topics/data-types#sets">sets</a>.</p>
</blockquote>
<p>查詢以特定 prefix 開頭、特定 data type 既 keys（第一頁，建議返回若干數量）：</p>
<pre><code class="language-bash">SCAN &quot;&lt;cursor&gt;&quot; MATCH &quot;&lt;key prefix&gt;*&quot; COUNT &quot;&lt;suggested result count&gt;&quot; TYPE &quot;&lt;string/list/set/zset/hash/stream&gt;&quot;
</code></pre>
<p>例子：</p>
<pre><code class="language-bash">MSET a 1 b 2 c 3 d 4 e 5 f 6 g 7 h 8 i 9 j 10 k 11 l 12 m 13 n 14 o 15 p 16 q 17 r 18 s 19 t 20 u 21 v 22 w 23 x 24 y 25 z 26
SCAN 0 MATCH &quot;*&quot; COUNT 10 TYPE string
SCAN ...
SCAN ...
（直至返回既 cursor 係 0）
</code></pre>
<p>結果係由 <code>2</code> 個 elements 組成：</p>
<ol>
<li>新既 cursor 數字，畀我地下次再 <code>SCAN</code> 果陣用。<!-- -->
<ul>
<li>例如佢返回既 cursor 係 <code>22</code>，咁我地下次就將句 command 改成 <code>SCAN 22 MATCH &quot;*&quot; COUNT 10 TYPE string</code>，直至到佢返回 <code>0</code> 既 cursor，咁先至代表已經係完成曬成個 search cycle。</li>
</ul>
</li>
<li>呢次 <code>SCAN</code> 指令查詢到既分頁結果，以 array 表示，elements 係 keys。</li>
</ol>
<p><img src="/blog/2022-07/redis-basics/redis-scan-command.png" alt=""/></p>
<p>註：</p>
<ul>
<li>一定要執行 <code>SCAN</code> 指令直至到 Redis 返回既 cursor 數字係 <code>0</code>，否則有可能會 miss 左一啲結果。</li>
<li>每次 <code>SCAN</code> 指令返回既結果數量都可以係意想不到，有可能少過、多過，或者等於我地 <code>COUNT</code> 所建議既數量。</li>
<li>同 <code>KEYS</code> 相似既地方係，返回既結果既次序同佢地新增既次序好可能會唔一樣。</li>
<li>雖然感覺有少少似 SQL <code>SELECT</code> 既 <code>WHERE LIMIT OFFSET</code> 分頁查詢，但實際上有好多唔相似既地方。<!-- -->
<ul>
<li>Redis 會先查詢 keys，之後再應用 <code>MATCH</code> 以及 <code>TYPE</code> 既 filters。<!-- -->
<ul>
<li>呢個設計有別於 SQL 先應用 <code>WHERE</code> 既條件，然後再應用 <code>LIMIT OFFSET</code> 實現分頁。</li>
<li>咁亦即係話，如果咁岩個分頁既 keys 全部唔中 pattern 或者 data type 既話，呢次 <code>SCAN</code> 既最終分頁查詢結果就會係 empty array，但係下一頁（下一個 <code>SCAN</code>）既結果反而有可能會係 non-empty array。所以一定要執行 <code>SCAN</code> 直至到佢返回 <code>0</code> 既 cursor。<!-- -->
<ul>
<li>
<blockquote>
<p>It is important to note that the MATCH filter is applied after elements are retrieved from the collection, just before returning data to the client. This means that if the pattern matches very little elements inside the collection, SCAN will likely return no elements in most iterations. An example is shown below:</p>
</blockquote>
</li>
</ul>
</li>
</ul>
</li>
<li>根據官網，<code>SCAN</code> 有可能會出現重複既結果，所以我地既程式係需要 handle 有重複結果既情況。<!-- -->
<ul>
<li>
<blockquote>
<p>A given element may be returned multiple times. It is up to the application to handle the case of duplicated elements, for example only using the returned elements in order to perform operations that are safe when re-applied multiple times.</p>
</blockquote>
</li>
</ul>
</li>
<li>如果有 element(s) 係喺 <code>SCAN</code> loop 進行緊既時候加入，佢地未必會出現喺結果裡面，呢樣野係話唔定。<!-- -->
<ul>
<li>
<blockquote>
<p>Elements that were not constantly present in the collection during a full iteration, may be returned or not: it is undefined.</p>
</blockquote>
</li>
</ul>
</li>
<li>如果有 element(s) 係喺 <code>SCAN</code> loop 進行既整個過程裡面都存在，咁佢地就保證一定會出現喺某次既結果裡面。</li>
<li>如果有 element(s) 係喺 <code>SCAN</code> loop 進行既整個過程裡面都唔存在，咁佢地就保證一定唔會出現喺任何結果裡面。</li>
</ul>
</li>
<li><code>COUNT</code>
<ul>
<li>代表「建議」分頁數量，類似 SQL 既 <code>LIMIT</code>。</li>
<li>默認值係 <code>10</code>。</li>
<li>呢個數字只係一個「建議」，基於 Redis 對於 <code>SCAN</code> 既處理方式以及 <code>MATCH</code> 既生效次序，Redis 最終唔一定會（好可能唔會）返回 exactly 呢個數量既 keys。</li>
</ul>
</li>
<li><code>SCAN</code> 後面既數字——cursor<!-- -->
<ul>
<li>感覺上類似 SQL 既 <code>OFFSET</code>，但事實上唔係。呢個數字喺一個完整既 <code>SCAN</code> loop 裡面可以增加亦可以減少。</li>
<li>因為 Redis 唔一定會返回我地 <code>COUNT</code> 所指定既數量，所以下一次再用 <code>SCAN</code> 查詢果陣，<code>SCAN</code> 後面既數字必須要用返目前 <code>SCAN</code> 查詢結果所返回既第 <code>1</code> 個 element 既數字。</li>
<li>一般用法係由 <code>0</code> 開始，直至下一次結果返回既第 <code>1</code> 個 element 係 <code>0</code>，咁先算係查詢曬所有結果（作為一個完整既 <code>SCAN</code> loop）。<!-- -->
<ul>
<li>但因為冇 server-side state，所以喺一個完整既 <code>SCAN</code> loop 裡面任何時候中斷查詢都冇問題。</li>
</ul>
</li>
</ul>
</li>
<li><code>MATCH</code>
<ul>
<li>同 <code>KEYS</code> 一樣都係用 glob-style 既 patterns。</li>
<li>佢會喺查詢完分頁既 keys 之後先至生效。</li>
</ul>
</li>
<li><code>TYPE</code>
<ul>
<li>可以係 <code>string</code>、<code>list</code>、<code>set</code>、<code>zset</code>、<code>hash</code> 或者 <code>stream</code>。</li>
<li>佢會喺查詢完分頁既 keys 之後先至生效。</li>
</ul>
</li>
</ul>
<p>參考資料：</p>
<ul>
<li><a href="https://redis.io/docs/latest/commands/scan/">Redis 官網 - SCAN</a></li>
</ul>
<hr/>
<h2>5.3 查詢 keys 存在與否</h2>
<p>查詢一個或多個 key(s) 存在與否：</p>
<pre><code class="language-bash">EXISTS &quot;&lt;key&gt;&quot; &quot;[&lt;key2&gt;...]&quot;
</code></pre>
<hr/>
<h1>6 Data types</h1>
<p>Redis 既 data types 指既係 key-value pair 既 value 所用既儲存格式。</p>
<table><thead><tr><th style="text-align:center">Data type</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">String</td><td>一般既文字格式，我地亦可以用 JSON 格式黎儲存 nested 既數據。</td></tr><tr><td style="text-align:center">List</td><td>基本上就係 Java 既 <code>List</code> 咁，會保留 elements 既新增次序。</td></tr><tr><td style="text-align:center">Set</td><td>基本上就係 Java 既 <code>Set</code> 咁，唔容許有重覆既 value。</td></tr><tr><td style="text-align:center">Hash</td><td>基本上就係 Java 既 <code>Map</code> 咁。</td></tr><tr><td style="text-align:center">Sorted Set</td><td>同 set 相似，但可以根據需要而給予 elements 先後次序。</td></tr></tbody></table>
<p>查詢某一個 key-value pair 既 value data type：</p>
<pre><code class="language-bash">TYPE &quot;&lt;key&gt;&quot;
</code></pre>
<p>以下會介紹最主要既幾種 data types：</p>
<ul>
<li>String</li>
<li>List</li>
<li>Set</li>
</ul>
<h2>6.1 String</h2>
<p>查詢 value：</p>
<pre><code class="language-bash">GET &quot;&lt;key&gt;&quot;
</code></pre>
<p>新增或覆蓋：</p>
<pre><code class="language-bash">SET &quot;&lt;key&gt;&quot; &quot;&lt;value&gt;&quot;
</code></pre>
<p>新增或覆蓋（附失效時間，以秒計）：</p>
<pre><code class="language-bash"># set expiration
SETEX &quot;&lt;key&gt;&quot; &quot;&lt;timeout in seconds&gt;&quot; &quot;&lt;value&gt;&quot;
</code></pre>
<p>刪除：</p>
<pre><code class="language-bash"># get and delete
GETDEL &quot;&lt;key&gt;&quot;
</code></pre>
<hr/>
<h2>6.2 List</h2>
<p>List 係冇得好似 Set 咁直接查詢某 value 存在與否。</p>
<p>查詢所有 elements：</p>
<pre><code class="language-bash"># list range
LRANGE &quot;&lt;key&gt;&quot; 0 -1
</code></pre>
<p>查詢 elements 既數量：</p>
<pre><code class="language-bash"># list length
LLEN &quot;&lt;key&gt;&quot;
</code></pre>
<p>新增一個或多個 element(s) 喺最前面：</p>
<pre><code class="language-bash"># left push
LPUSH &quot;&lt;key&gt;&quot; &quot;&lt;value&gt;&quot; &quot;[&lt;value2&gt;...]&quot;
</code></pre>
<p>新增一個或多個 element(s) 喺最後面：</p>
<pre><code class="language-bash"># right push
RPUSH &quot;&lt;key&gt;&quot; &quot;&lt;value&gt;&quot; &quot;[&lt;value2&gt;...]&quot;
</code></pre>
<p>根據 value 刪除所有匹配既 elements：</p>
<pre><code class="language-bash"># list remove
LREM &quot;&lt;key&gt;&quot; 0 &quot;&lt;value&gt;&quot;
</code></pre>
<p>刪除最前面既一個或多個 element(s) 並且返回佢或佢地既 value(s)：</p>
<pre><code class="language-bash"># left pop
LPOP &quot;&lt;key&gt;&quot; &quot;[&lt;count&gt;]&quot;
</code></pre>
<p>刪除最後面既一個或多個 element(s) 並且返回佢或佢地既 value(s)：</p>
<pre><code class="language-bash"># right pop
RPOP &quot;&lt;key&gt;&quot; &quot;[&lt;count&gt;]&quot;
</code></pre>
<hr/>
<h2>6.3 Set</h2>
<p>查詢所有 elements：</p>
<pre><code class="language-bash"># set members
SMEMBERS &quot;&lt;key&gt;&quot;
</code></pre>
<p>查詢 elements 既數量：</p>
<pre><code class="language-bash"># set cardinality
SCARD &quot;&lt;key&gt;&quot;
</code></pre>
<p>新增一個或多個 element(s)：</p>
<pre><code class="language-bash"># set add
SADD &quot;&lt;key&gt;&quot; &quot;&lt;value&gt;&quot; &quot;[&lt;value2&gt;...]&quot;
</code></pre>
<p>刪除一個或多個 element(s)：</p>
<pre><code class="language-bash"># set remove
SREM &quot;&lt;key&gt;&quot; &quot;&lt;value&gt;&quot; &quot;[&lt;value2&gt;...]&quot;
</code></pre>
<p>刪除一個或多個任意既 element(s) 並且返回佢或佢地既 value(s)：</p>
<pre><code class="language-bash"># set pop
SPOP &quot;&lt;key&gt;&quot;
</code></pre>
<p>查詢某 value 存在與否：</p>
<pre><code class="language-bash"># set is member
SISMEMBER &quot;&lt;key&gt;&quot; &quot;&lt;value&gt;&quot;
</code></pre>
<p>查詢一個或多個任意既 element(s) 既 value(s)：</p>
<pre><code class="language-bash"># set random member
SRANDMEMBER &quot;&lt;key&gt;&quot; &quot;[&lt;count&gt;]&quot;
</code></pre>
<hr/>
<h1>7 其他指令</h1>
<h2>7.1 登入</h2>
<pre><code class="language-bash">AUTH &quot;&lt;password&gt;&quot;
</code></pre>
<hr/>
<h2>7.2 查詢客戶端連線資料</h2>
<pre><code class="language-bash">CLIENT INFO
</code></pre>
<hr/>
<h2>7.3 CLI 內建既指令使用手冊</h2>
<pre><code class="language-bash">HELP @string
HELP @list
HELP @set
HELP @hash
HELP @sorted-set
</code></pre>
<hr/>
<h1>8 參考資料</h1>
<ul>
<li><a href="http://redisdoc.com/">Redis 命令參考</a></li>
<li>Redis 官網<!-- -->
<ul>
<li><a href="https://redis.io/docs/latest/develop/data-types/">Understand Redis data types</a></li>
<li><a href="https://redis.io/docs/latest/commands/?group=string">String commands</a></li>
<li><a href="https://redis.io/docs/latest/commands/?group=list">List commands</a></li>
<li><a href="https://redis.io/docs/latest/commands/?group=set">Set commands</a></li>
</ul>
</li>
<li><a href="https://stackoverflow.com/questions/10489298/redis-is-single-threaded-then-how-does-it-do-concurrent-i-o">StackOverflow - Redis is single-threaded, then how does it do concurrent I/O?</a></li>
</ul><hr/><div class="vstack gap-3"><div class="text-center container"><div class="justify-content-center g-3 row row-cols-md-3 row-cols-sm-2 row-cols-1"><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="tel:+85263301333"><div class="card-body"><div class="card-title h5"><i class="fa-solid fa-phone" style="color:#009688"></i></div><p class="text-muted card-text">6330 1333<!-- --> </p></div></a></div><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="mailto:michaelboyboy@gmail.com"><div class="card-body"><div class="card-title h5"><i class="fa-solid fa-envelope" style="color:#f44336"></i></div><p class="text-muted card-text">michaelboyboy@gmail.com<!-- --> </p></div></a></div><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="https://www.linkedin.com/in/mickchung"><div class="card-body"><div class="card-title h5"><i class="fa-brands fa-linkedin" style="color:#2196f3"></i></div><p class="text-muted card-text">www.linkedin.com/in/mickchung<!-- --> </p></div></a></div></div></div></div></div><script src="/e2-next/_next/static/chunks/webpack-f088da4552bcc253.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[8287,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\n3:I[3339,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n4:I[1367,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\n5:I[5244,[],\"\"]\n6:I[3866,[],\"\"]\n7:I[4798,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n8:I[6121,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n9:I[3667,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\na:I[8407,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nb:I[8173,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"\"]\nc:I[3197,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nd:I[7933,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\ne:I[3800,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nf:I[6213,[],\"OutletBoundary\"]\n11:I[6213,[],\"MetadataBoundary\"]\n13:I[6213,[],\"ViewportBoundary\"]\n15:I[4835,[],\"\"]\n:HL[\"/e2-next/_next/static/css/d3df112486f97f47.css\",\"style\"]\n:HL[\"/e2-next/_next/static/css/c3624a693ae5a0c4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"wfZ4FdS4ntgGvzjeKJhfw\",\"p\":\"/e2-next\",\"c\":[\"\",\"blog\",\"redis-basics\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[\"(2022-07)\",{\"children\":[\"redis-basics\",{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/e2-next/_next/static/css/d3df112486f97f47.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/e2-next/_next/static/css/c3624a693ae5a0c4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css\"}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"gap\":5,\"children\":[[\"$\",\"$L3\",null,{\"gap\":5,\"className\":\"text-center\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"code\",null,{\"className\":\"SiteHeader_name__cwQmL\",\"children\":\"Chung Cheuk Hang Michael\"}],[\"$\",\"code\",null,{\"className\":\"SiteHeader_title__CCfvI\",\"children\":\"Java Web Developer\"}]]}],[\"$\",\"$L4\",null,{}]]}],[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"hr\",null,{}],[\"$\",\"$L3\",null,{\"gap\":3,\"children\":[\"$\",\"$L7\",null,{\"className\":\"text-center\",\"children\":[\"$\",\"$L8\",null,{\"xs\":1,\"sm\":2,\"md\":3,\"className\":\"justify-content-center g-3\",\"children\":[[\"$\",\"$L9\",\"0\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"tel:+85263301333\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-solid fa-phone\",\"style\":{\"color\":\"#009688\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"6330 1333\",\" \"]}]]}]}]}],[\"$\",\"$L9\",\"1\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"mailto:michaelboyboy@gmail.com\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-solid fa-envelope\",\"style\":{\"color\":\"#f44336\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"michaelboyboy@gmail.com\",\" \"]}]]}]}]}],[\"$\",\"$L9\",\"2\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"https://www.linkedin.com/in/mickchung\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-brands fa-linkedin\",\"style\":{\"color\":\"#2196f3\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"www.linkedin.com/in/mickchung\",\" \"]}]]}]}]}]]}]}]}]]}]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"(2022-07)\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"(2022-07)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"redis-basics\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"(2022-07)\",\"children\",\"redis-basics\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"h1\",null,{\"children\":\"1 Redis 簡介\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"關於 Redis 既基本簡介可以喺呢篇度搵到：\",[\"$\",\"a\",null,{\"href\":\"/blog/spring-caching-redis#1-redis-%E7%B0%A1%E4%BB%8B\",\"children\":\"Spring 項目使用 Redis 做 caching - Redis 簡介\"}],\"。\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"2 基本概念\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Redis 有 \",[\"$\",\"code\",null,{\"children\":\"16\"}],\" 個 databases（\",[\"$\",\"code\",null,{\"children\":\"0\"}],\"-based，\",[\"$\",\"code\",null,{\"children\":\"0\"}],\" 至 \",[\"$\",\"code\",null,{\"children\":\"15\"}],\"），每個 database 裡面既數據都係以 key-value pair 既形式儲存。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Redis 既 data types 指既係 key-value pair 既 value 所用既儲存格式。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"3 本地運行\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"關於點樣本地運行 Redis 可以喺呢篇度搵到：\",[\"$\",\"a\",null,{\"href\":\"/blog/spring-caching-redis#2-%E5%AE%89%E8%A3%9D\",\"children\":\"Spring 項目使用 Redis 做 caching - 安裝\"}],\"。\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"4 Database 操作\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"4.1 選擇 database\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Redis CLI 成功連接之後，初始選擇既係 database \",[\"$\",\"code\",null,{\"children\":\"0\"}],\"。\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"SELECT \\\"\u003cdatabase index, 0~15\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"4.2 查詢目前 database 資料數量\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢目前所選擇既 database 既資料數量（key 數量）：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# database size\\r\\nDBSIZE\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"4.3 刪除目前 database 內所有資料\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"以下指令會刪除目前所選擇既 database 既所有資料：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# flush database\\r\\nFLUSHDB\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"4.4 刪除所有資料\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"以下指令會刪除所有 databases 既所有資料：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# flush all\\r\\nFLUSHALL\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"5 查詢 keys\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":[\"5.1 \",[\"$\",\"code\",null,{\"children\":\"KEYS\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢所有 keys：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"KEYS *\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"我地亦可以使用 glob-style 既 patterns 去查詢 keys，例如用 \",[\"$\",\"code\",null,{\"children\":\"*\"}],\" 代表任意長度既任意值。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢以特定 prefix 開頭既 keys：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"KEYS \\\"\u003ckey prefix\u003e*\\\"\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":[\"5.2 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"根據 Redis 官網呢篇關於 \",[\"$\",\"code\",null,{\"children\":\"KEYS\"}],\" 指令既文檔——\",[\"$\",\"a\",null,{\"href\":\"https://redis.io/docs/latest/commands/keys/\",\"children\":\"KEYS pattern\"}],\"，我地最好唔好喺 Production 環境用 \",[\"$\",\"code\",null,{\"children\":\"KEYS\"}],\"：\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Warning\"}],\": consider \",[\"$\",\"code\",null,{\"children\":\"KEYS\"}],\" as a command that should only be used in production environments with extreme care. It may ruin performance when it is executed against large databases. This command is intended for debugging and special operations, such as changing your keyspace layout. Don't use \",[\"$\",\"code\",null,{\"children\":\"KEYS\"}],\" in your regular application code. If you're looking for a way to find keys in a subset of your keyspace, consider using \",[\"$\",\"a\",null,{\"href\":\"https://redis.io/commands/scan\",\"children\":[\"$\",\"code\",null,{\"children\":\"SCAN\"}]}],\" or \",[\"$\",\"a\",null,{\"href\":\"https://redis.io/topics/data-types#sets\",\"children\":\"sets\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢以特定 prefix 開頭、特定 data type 既 keys（第一頁，建議返回若干數量）：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"SCAN \\\"\u003ccursor\u003e\\\" MATCH \\\"\u003ckey prefix\u003e*\\\" COUNT \\\"\u003csuggested result count\u003e\\\" TYPE \\\"\u003cstring/list/set/zset/hash/stream\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"例子：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"MSET a 1 b 2 c 3 d 4 e 5 f 6 g 7 h 8 i 9 j 10 k 11 l 12 m 13 n 14 o 15 p 16 q 17 r 18 s 19 t 20 u 21 v 22 w 23 x 24 y 25 z 26\\r\\nSCAN 0 MATCH \\\"*\\\" COUNT 10 TYPE string\\r\\nSCAN ...\\r\\nSCAN ...\\r\\n（直至返回既 cursor 係 0）\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"結果係由 \",[\"$\",\"code\",null,{\"children\":\"2\"}],\" 個 elements 組成：\"]}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"新既 cursor 數字，畀我地下次再 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 果陣用。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"例如佢返回既 cursor 係 \",[\"$\",\"code\",null,{\"children\":\"22\"}],\"，咁我地下次就將句 command 改成 \",[\"$\",\"code\",null,{\"children\":\"SCAN 22 MATCH \\\"*\\\" COUNT 10 TYPE string\"}],\"，直至到佢返回 \",[\"$\",\"code\",null,{\"children\":\"0\"}],\" 既 cursor，咁先至代表已經係完成曬成個 search cycle。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"呢次 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 指令查詢到既分頁結果，以 array 表示，elements 係 keys。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/blog/2022-07/redis-basics/redis-scan-command.png\",\"alt\":\"\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"註：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"一定要執行 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 指令直至到 Redis 返回既 cursor 數字係 \",[\"$\",\"code\",null,{\"children\":\"0\"}],\"，否則有可能會 miss 左一啲結果。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"每次 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 指令返回既結果數量都可以係意想不到，有可能少過、多過，或者等於我地 \",[\"$\",\"code\",null,{\"children\":\"COUNT\"}],\" 所建議既數量。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"同 \",[\"$\",\"code\",null,{\"children\":\"KEYS\"}],\" 相似既地方係，返回既結果既次序同佢地新增既次序好可能會唔一樣。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"雖然感覺有少少似 SQL \",[\"$\",\"code\",null,{\"children\":\"SELECT\"}],\" 既 \",[\"$\",\"code\",null,{\"children\":\"WHERE LIMIT OFFSET\"}],\" 分頁查詢，但實際上有好多唔相似既地方。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Redis 會先查詢 keys，之後再應用 \",[\"$\",\"code\",null,{\"children\":\"MATCH\"}],\" 以及 \",[\"$\",\"code\",null,{\"children\":\"TYPE\"}],\" 既 filters。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"呢個設計有別於 SQL 先應用 \",[\"$\",\"code\",null,{\"children\":\"WHERE\"}],\" 既條件，然後再應用 \",[\"$\",\"code\",null,{\"children\":\"LIMIT OFFSET\"}],\" 實現分頁。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"咁亦即係話，如果咁岩個分頁既 keys 全部唔中 pattern 或者 data type 既話，呢次 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 既最終分頁查詢結果就會係 empty array，但係下一頁（下一個 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\"）既結果反而有可能會係 non-empty array。所以一定要執行 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 直至到佢返回 \",[\"$\",\"code\",null,{\"children\":\"0\"}],\" 既 cursor。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"It is important to note that the MATCH filter is applied after elements are retrieved from the collection, just before returning data to the client. This means that if the pattern matches very little elements inside the collection, SCAN will likely return no elements in most iterations. An example is shown below:\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"根據官網，\",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 有可能會出現重複既結果，所以我地既程式係需要 handle 有重複結果既情況。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"A given element may be returned multiple times. It is up to the application to handle the case of duplicated elements, for example only using the returned elements in order to perform operations that are safe when re-applied multiple times.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果有 element(s) 係喺 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" loop 進行緊既時候加入，佢地未必會出現喺結果裡面，呢樣野係話唔定。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"Elements that were not constantly present in the collection during a full iteration, may be returned or not: it is undefined.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果有 element(s) 係喺 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" loop 進行既整個過程裡面都存在，咁佢地就保證一定會出現喺某次既結果裡面。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果有 element(s) 係喺 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" loop 進行既整個過程裡面都唔存在，咁佢地就保證一定唔會出現喺任何結果裡面。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"COUNT\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"代表「建議」分頁數量，類似 SQL 既 \",[\"$\",\"code\",null,{\"children\":\"LIMIT\"}],\"。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"默認值係 \",[\"$\",\"code\",null,{\"children\":\"10\"}],\"。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"呢個數字只係一個「建議」，基於 Redis 對於 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 既處理方式以及 \",[\"$\",\"code\",null,{\"children\":\"MATCH\"}],\" 既生效次序，Redis 最終唔一定會（好可能唔會）返回 exactly 呢個數量既 keys。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 後面既數字——cursor\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"感覺上類似 SQL 既 \",[\"$\",\"code\",null,{\"children\":\"OFFSET\"}],\"，但事實上唔係。呢個數字喺一個完整既 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" loop 裡面可以增加亦可以減少。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"因為 Redis 唔一定會返回我地 \",[\"$\",\"code\",null,{\"children\":\"COUNT\"}],\" 所指定既數量，所以下一次再用 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 查詢果陣，\",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 後面既數字必須要用返目前 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" 查詢結果所返回既第 \",[\"$\",\"code\",null,{\"children\":\"1\"}],\" 個 element 既數字。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"一般用法係由 \",[\"$\",\"code\",null,{\"children\":\"0\"}],\" 開始，直至下一次結果返回既第 \",[\"$\",\"code\",null,{\"children\":\"1\"}],\" 個 element 係 \",[\"$\",\"code\",null,{\"children\":\"0\"}],\"，咁先算係查詢曬所有結果（作為一個完整既 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" loop）。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"但因為冇 server-side state，所以喺一個完整既 \",[\"$\",\"code\",null,{\"children\":\"SCAN\"}],\" loop 裡面任何時候中斷查詢都冇問題。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"MATCH\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"同 \",[\"$\",\"code\",null,{\"children\":\"KEYS\"}],\" 一樣都係用 glob-style 既 patterns。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"佢會喺查詢完分頁既 keys 之後先至生效。\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"TYPE\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"可以係 \",[\"$\",\"code\",null,{\"children\":\"string\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"list\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"set\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"zset\"}],\"、\",[\"$\",\"code\",null,{\"children\":\"hash\"}],\" 或者 \",[\"$\",\"code\",null,{\"children\":\"stream\"}],\"。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"佢會喺查詢完分頁既 keys 之後先至生效。\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"參考資料：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://redis.io/docs/latest/commands/scan/\",\"children\":\"Redis 官網 - SCAN\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"5.3 查詢 keys 存在與否\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢一個或多個 key(s) 存在與否：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"EXISTS \\\"\u003ckey\u003e\\\" \\\"[\u003ckey2\u003e...]\\\"\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"6 Data types\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Redis 既 data types 指既係 key-value pair 既 value 所用既儲存格式。\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"style\":{\"textAlign\":\"center\"},\"children\":\"Data type\"}],[\"$\",\"th\",null,{\"children\":\"描述\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"center\"},\"children\":\"String\"}],[\"$\",\"td\",null,{\"children\":\"一般既文字格式，我地亦可以用 JSON 格式黎儲存 nested 既數據。\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"center\"},\"children\":\"List\"}],[\"$\",\"td\",null,{\"children\":[\"基本上就係 Java 既 \",[\"$\",\"code\",null,{\"children\":\"List\"}],\" 咁，會保留 elements 既新增次序。\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"center\"},\"children\":\"Set\"}],[\"$\",\"td\",null,{\"children\":[\"基本上就係 Java 既 \",[\"$\",\"code\",null,{\"children\":\"Set\"}],\" 咁，唔容許有重覆既 value。\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"center\"},\"children\":\"Hash\"}],[\"$\",\"td\",null,{\"children\":[\"基本上就係 Java 既 \",[\"$\",\"code\",null,{\"children\":\"Map\"}],\" 咁。\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"style\":{\"textAlign\":\"center\"},\"children\":\"Sorted Set\"}],[\"$\",\"td\",null,{\"children\":\"同 set 相似，但可以根據需要而給予 elements 先後次序。\"}]]}]]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢某一個 key-value pair 既 value data type：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"TYPE \\\"\u003ckey\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"以下會介紹最主要既幾種 data types：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"String\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"List\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Set\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"6.1 String\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢 value：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"GET \\\"\u003ckey\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"新增或覆蓋：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"SET \\\"\u003ckey\u003e\\\" \\\"\u003cvalue\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"新增或覆蓋（附失效時間，以秒計）：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set expiration\\r\\nSETEX \\\"\u003ckey\u003e\\\" \\\"\u003ctimeout in seconds\u003e\\\" \\\"\u003cvalue\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"刪除：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# get and delete\\r\\nGETDEL \\\"\u003ckey\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"6.2 List\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"List 係冇得好似 Set 咁直接查詢某 value 存在與否。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢所有 elements：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# list range\\r\\nLRANGE \\\"\u003ckey\u003e\\\" 0 -1\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢 elements 既數量：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# list length\\r\\nLLEN \\\"\u003ckey\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"新增一個或多個 element(s) 喺最前面：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# left push\\r\\nLPUSH \\\"\u003ckey\u003e\\\" \\\"\u003cvalue\u003e\\\" \\\"[\u003cvalue2\u003e...]\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"新增一個或多個 element(s) 喺最後面：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# right push\\r\\nRPUSH \\\"\u003ckey\u003e\\\" \\\"\u003cvalue\u003e\\\" \\\"[\u003cvalue2\u003e...]\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"根據 value 刪除所有匹配既 elements：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# list remove\\r\\nLREM \\\"\u003ckey\u003e\\\" 0 \\\"\u003cvalue\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"刪除最前面既一個或多個 element(s) 並且返回佢或佢地既 value(s)：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# left pop\\r\\nLPOP \\\"\u003ckey\u003e\\\" \\\"[\u003ccount\u003e]\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"刪除最後面既一個或多個 element(s) 並且返回佢或佢地既 value(s)：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# right pop\\r\\nRPOP \\\"\u003ckey\u003e\\\" \\\"[\u003ccount\u003e]\\\"\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"6.3 Set\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢所有 elements：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set members\\r\\nSMEMBERS \\\"\u003ckey\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢 elements 既數量：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set cardinality\\r\\nSCARD \\\"\u003ckey\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"新增一個或多個 element(s)：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set add\\r\\nSADD \\\"\u003ckey\u003e\\\" \\\"\u003cvalue\u003e\\\" \\\"[\u003cvalue2\u003e...]\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"刪除一個或多個 element(s)：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set remove\\r\\nSREM \\\"\u003ckey\u003e\\\" \\\"\u003cvalue\u003e\\\" \\\"[\u003cvalue2\u003e...]\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"刪除一個或多個任意既 element(s) 並且返回佢或佢地既 value(s)：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set pop\\r\\nSPOP \\\"\u003ckey\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢某 value 存在與否：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set is member\\r\\nSISMEMBER \\\"\u003ckey\u003e\\\" \\\"\u003cvalue\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"查詢一個或多個任意既 element(s) 既 value(s)：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# set random member\\r\\nSRANDMEMBER \\\"\u003ckey\u003e\\\" \\\"[\u003ccount\u003e]\\\"\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"7 其他指令\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"7.1 登入\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"AUTH \\\"\u003cpassword\u003e\\\"\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"7.2 查詢客戶端連線資料\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"CLIENT INFO\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"7.3 CLI 內建既指令使用手冊\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"HELP @string\\r\\nHELP @list\\r\\nHELP @set\\r\\nHELP @hash\\r\\nHELP @sorted-set\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"8 參考資料\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"http://redisdoc.com/\",\"children\":\"Redis 命令參考\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Redis 官網\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://redis.io/docs/latest/develop/data-types/\",\"children\":\"Understand Redis data types\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://redis.io/docs/latest/commands/?group=string\",\"children\":\"String commands\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://redis.io/docs/latest/commands/?group=list\",\"children\":\"List commands\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://redis.io/docs/latest/commands/?group=set\",\"children\":\"Set commands\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://stackoverflow.com/questions/10489298/redis-is-single-threaded-then-how-does-it-do-concurrent-i-o\",\"children\":\"StackOverflow - Redis is single-threaded, then how does it do concurrent I/O?\"}]}],\"\\n\"]}]],null,[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"No6_pqjGAN4XLpYZYHx3_\",{\"children\":[[\"$\",\"$L11\",null,{\"children\":\"$L12\"}],[\"$\",\"$L13\",null,{\"children\":\"$L14\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$15\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"14:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n12:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Michael Chung's e-Portfolio\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Powered by Next.js and React\"}]]\n"])</script><script>self.__next_f.push([1,"10:null\n"])</script></body></html>