1:"$Sreact.fragment"
2:I[8287,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","2153","static/chunks/2153-45fd9844831c6348.js","7177","static/chunks/app/layout-ea91c2d128ec48c2.js"],"default"]
3:I[3339,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","8974","static/chunks/app/page-c8b940db14fac9a0.js"],"default"]
4:I[1367,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","2153","static/chunks/2153-45fd9844831c6348.js","7177","static/chunks/app/layout-ea91c2d128ec48c2.js"],"default"]
5:I[5244,[],""]
6:I[3866,[],""]
7:I[4798,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","8974","static/chunks/app/page-c8b940db14fac9a0.js"],"default"]
8:I[6121,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","8974","static/chunks/app/page-c8b940db14fac9a0.js"],"default"]
9:I[3667,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","8974","static/chunks/app/page-c8b940db14fac9a0.js"],"default"]
a:I[8407,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","2153","static/chunks/2153-45fd9844831c6348.js","7177","static/chunks/app/layout-ea91c2d128ec48c2.js"],"default"]
b:I[8173,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","8974","static/chunks/app/page-c8b940db14fac9a0.js"],""]
c:I[3197,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","2153","static/chunks/2153-45fd9844831c6348.js","7177","static/chunks/app/layout-ea91c2d128ec48c2.js"],"default"]
d:I[7933,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","2153","static/chunks/2153-45fd9844831c6348.js","7177","static/chunks/app/layout-ea91c2d128ec48c2.js"],"default"]
e:I[3800,["7829","static/chunks/7829-b7b9eb1dbe0d40e4.js","2153","static/chunks/2153-45fd9844831c6348.js","7177","static/chunks/app/layout-ea91c2d128ec48c2.js"],"default"]
11:I[6213,[],"OutletBoundary"]
13:I[6213,[],"MetadataBoundary"]
15:I[6213,[],"ViewportBoundary"]
17:I[4835,[],""]
:HL["/e2-next/_next/static/css/d3df112486f97f47.css","style"]
:HL["/e2-next/_next/static/css/c3624a693ae5a0c4.css","style"]
f:T8f9,<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.michael</groupId>
    <artifactId>Spring-Boot-2-Playground</artifactId>
    <version>1.0.0</version>
    <packaging>jar</packaging>

    <name>Spring-Boot-2-Playground</name>
    <description>Spring Boot 2 Playground</description>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.15</version>
    </parent>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        <javac.source>11</javac.source>
        <javac.target>11</javac.target>
        <maven.compiler.target>11</maven.compiler.target>
        <maven.compiler.source>11</maven.compiler.source>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-aop</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-devtools</artifactId>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <mainClass>code.MainApplication</mainClass>
                </configuration>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project>
10:T417,@Slf4j
@Aspect
@Component
public class ServiceAspect {

    @Around("execution(* code.service.*.*(..))")
    public Object logging(ProceedingJoinPoint joinPoint) throws Throwable {

        final List<Object> args = Arrays.asList(joinPoint.getArgs());
        final MethodSignature method = (MethodSignature) joinPoint.getSignature();
        final Class<?> returnType = method.getReturnType();
        final String methodName = method.getMethod().getName();
        final String className = method.getDeclaringType().getSimpleName();

        log.info("{}.{} is called. Arguments: {}", className, methodName, args);

        try {
            final Object returnValue = joinPoint.proceed();

            log.info("{}.{} returns [class: {}]: {}", className, methodName, returnType.getCanonicalName(), returnValue);

            return returnValue;
        } catch (Throwable e) {
            log.info("{}.{} throws exception [class: {}].", className, methodName, e.getClass(), e);
            throw e;
        }
    }
}
0:{"P":null,"b":"wfZ4FdS4ntgGvzjeKJhfw","p":"/e2-next","c":["","blog","spring-aop"],"i":false,"f":[[["",{"children":["blog",{"children":["(2021-09)",{"children":["spring-aop",{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/e2-next/_next/static/css/d3df112486f97f47.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/e2-next/_next/static/css/c3624a693ae5a0c4.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"href":"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","rel":"stylesheet"}],["$","link",null,{"rel":"stylesheet","href":"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"}]]}],["$","body",null,{"children":["$","$L2",null,{"children":["$","$L3",null,{"gap":5,"children":[["$","$L3",null,{"gap":5,"className":"text-center","children":[["$","div",null,{"children":[["$","code",null,{"className":"SiteHeader_name__cwQmL","children":"Chung Cheuk Hang Michael"}],["$","code",null,{"className":"SiteHeader_title__CCfvI","children":"Java Web Developer"}]]}],["$","$L4",null,{}]]}],["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]]],"forbidden":"$undefined","unauthorized":"$undefined"}],["$","hr",null,{}],["$","$L3",null,{"gap":3,"children":["$","$L7",null,{"className":"text-center","children":["$","$L8",null,{"xs":1,"sm":2,"md":3,"className":"justify-content-center g-3","children":[["$","$L9","0",{"children":["$","$La",null,{"as":"$b","href":"tel:+85263301333","target":"_blank","rel":"external nofollow noopener noreferrer","className":"SiteFooter_contact-item__2JRRr","children":["$","$Lc",null,{"children":[["$","$Ld",null,{"children":["$","i",null,{"className":"fa-solid fa-phone","style":{"color":"#009688"}}]}],["$","$Le",null,{"className":"text-muted","children":["6330 1333"," "]}]]}]}]}],["$","$L9","1",{"children":["$","$La",null,{"as":"$b","href":"mailto:michaelboyboy@gmail.com","target":"_blank","rel":"external nofollow noopener noreferrer","className":"SiteFooter_contact-item__2JRRr","children":["$","$Lc",null,{"children":[["$","$Ld",null,{"children":["$","i",null,{"className":"fa-solid fa-envelope","style":{"color":"#f44336"}}]}],["$","$Le",null,{"className":"text-muted","children":["michaelboyboy@gmail.com"," "]}]]}]}]}],["$","$L9","2",{"children":["$","$La",null,{"as":"$b","href":"https://www.linkedin.com/in/mickchung","target":"_blank","rel":"external nofollow noopener noreferrer","className":"SiteFooter_contact-item__2JRRr","children":["$","$Lc",null,{"children":[["$","$Ld",null,{"children":["$","i",null,{"className":"fa-brands fa-linkedin","style":{"color":"#2196f3"}}]}],["$","$Le",null,{"className":"text-muted","children":["www.linkedin.com/in/mickchung"," "]}]]}]}]}]]}]}]}]]}]}]}]]}]]}],{"children":["blog",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["(2021-09)",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","(2021-09)","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["spring-aop",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","(2021-09)","children","spring-aop","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":[[["$","h1",null,{"children":"1 Spring AOP 簡介"}],"\n",["$","p",null,{"children":["AOP 即係 aspect-oriented programming，係一個畀我地從其他角度（如業務角度、功能角度）加插執行代碼既一個設計。簡單啲講，Spring AOP 就係一個做法，可以方便我地做到某啲特別既操作，亦唔需要改到原來既 code，而呢啲功能可能係需要針對一堆相類似既 classes，例如係 service layer 既 classes（帶 ",["$","code",null,{"children":"@Service"}],"），去做一啲微細又或者毀滅性既操作。"]}],"\n",["$","h2",null,{"children":"1.1 Spring AOP 可以進行既操作"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["喺一個 Spring bean 既 method 被 call 之前做啲野","\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"截取 input argument values"}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["決定 call 啲乜野、點樣 call","\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"唔 call 原先個 method"}],"\n",["$","li",null,{"children":"call 原先個 method，但 supply 唔同既 argument values"}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["喺一個 Spring bean 既 method 被 call 之後做啲野","\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"截取 output return value"}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"children":"1.2 Spring AOP 既應用"}],"\n",["$","h3",null,{"children":"1.2.1 Spring Framework 本身"}],"\n",["$","p",null,{"children":["Spring 既 declarative transaction management 就正正係應用左 Spring AOP，亦即係我地寫 JPA/Hibernate 果陣用到既 ",["$","code",null,{"children":"@Transactional"}],"，佢既背後就係由 Spring AOP 實現。"]}],"\n",["$","p",null,{"children":["Spring 官方 doc 裡面既 ",["$","a",null,{"href":"https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#transaction-declarative","children":"Declarative Transaction Management"}]," 提到："]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":"The Spring Framework's declarative transaction management is made possible with Spring aspect-oriented programming (AOP)."}],"\n"]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":["The most important concepts to grasp with regard to the Spring Framework's declarative transaction support are that this support is enabled ",["$","a",null,{"href":"https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#aop-understanding-aop-proxies","children":"via AOP proxies"}]," and that the transactional advice is driven by metadata (currently XML- or annotation-based)."]}],"\n"]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"children":"1.2.2 自定義應用場景"}],"\n",["$","p",null,{"children":"而其他應用場景有："}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"style":{"textAlign":"center"},"children":"應用場景"}],["$","th",null,{"children":"描述"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"style":{"textAlign":"center"},"children":"Logging"}],["$","td",null,{"children":"截取 input 及 output，用 logger log 低，方便 debug 或者 troubleshoot。"}]]}],["$","tr",null,{"children":[["$","td",null,{"style":{"textAlign":"center"},"children":"數據校驗"}],["$","td",null,{"children":"對特定參數進行校驗。"}]]}],["$","tr",null,{"children":[["$","td",null,{"style":{"textAlign":"center"},"children":"Mocking"}],["$","td",null,{"children":"取締原來既 output。"}]]}]]}]]}],"\n",["$","p",null,{"children":["至於做 authentication，即係去 check 下個 HTTP request 來自既用戶登入左未、session 係咪 valid，我地就可以用 filters，例如 ",["$","code",null,{"children":"OncePerRequestFilter"}],"。"]}],"\n",["$","hr",null,{}],"\n",["$","h1",null,{"children":"2 動手使用 Spring AOP 做 logging"}],"\n",["$","h2",null,{"children":"2.1 用 Spring AOP 做既原因"}],"\n",["$","p",null,{"children":["試想像下而家有一個 Spring web application，裡面有好多唔同既 service classes，如果我地想對佢地加 logging，去 log 所有 ",["$","code",null,{"children":"public"}]," 既 service methods 被 call 果陣既 arguments 同埋 return 返出去既 value。"]}],"\n",["$","p",null,{"children":"我地與其逐個 service method 咁改，倒不如將 logging 既 code 放喺同一個位度，除左方便，咁亦都可以令我地個系統既設計變得 modular，因為 logging 既 code 寫埋一邊，而 service classes 裡面就只有 business logic，河水不犯井水。"}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"children":"2.2 Maven dependencies"}],"\n",["$","p",null,{"children":["Spring 本身都已經有引入 Spring AOP，因為 Spring AOP 係 Spring 既核心功能，好多其他功能都係基於 Spring AOP，例如 JPA 既 transactions，所以唔需要特登加 ",["$","code",null,{"children":"spring-boot-starter-aop"}]," 既 dependency。"]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-xml","children":"$f"}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"children":"2.3 寫 Java code"}],"\n",["$","p",null,{"children":"Project structure："}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","code",null,{"children":"src/main/java"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","code",null,{"children":"/code"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","code",null,{"children":"/controller"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","code",null,{"children":"HomeController.java"}]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":[["$","code",null,{"children":"/service"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","code",null,{"children":"HomeService.java"}]}],"\n",["$","li",null,{"children":["$","code",null,{"children":"ServiceAspect.java"}]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["$","code",null,{"children":"MainApplication.java"}]}],"\n"]}],"\n"]}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"children":"2.3.1 Application 入口"}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"MainApplication.java"}],"："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-java","children":"@SpringBootApplication\r\npublic class MainApplication {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(MainApplication.class, args);\r\n    }\r\n}\n"}]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"children":"2.3.2 Controller layer"}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"HomeController.java"}],"："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-java","children":"@RestController\r\npublic class HomeController {\r\n\r\n    @Autowired\r\n    HomeService homeService;\r\n\r\n    @GetMapping(\"/{name}\")\r\n    public String greet(@PathVariable(\"name\") String name) {\r\n        return homeService.greet(name);\r\n    }\r\n}\n"}]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"children":"2.3.3 Service layer"}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"HomeService.java"}],"："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-java","children":"@Service\r\npublic class HomeService {\r\n\r\n    public String greet(String name) {\r\n        return \"Hi, \" + name;\r\n    }\r\n}\n"}]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"children":["2.3.4 AOP ",["$","code",null,{"children":"@Aspect"}]," component"]}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"ServiceAspect.java"}],"："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-java","children":"$10"}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"children":"2.4 測試"}],"\n",["$","h3",null,{"children":"2.4.1 啟動 Spring Boot web application"}],"\n",["$","p",null,{"children":["執行下面既 command，或者喺 IDE 裡面 run ",["$","code",null,{"children":"MainApplication"}]," 既 ",["$","code",null,{"children":"main"}]," method："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-bash","children":"mvn spring-boot:run\n"}]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"children":"2.4.2 Call API"}],"\n",["$","p",null,{"children":["執行下面既 command，或者喺 Postman 裡面 call ",["$","code",null,{"children":"GET localhost:8080/mick"}],"："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-bash","children":"curl --request GET \"localhost:8080/mick\"\n"}]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"children":"2.4.3 檢視結果 + 討論"}],"\n",["$","p",null,{"children":"留意 Spring Boot 既 console log，我地會見到："}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-plaintext","children":"HomeService.greet is called. Arguments: [mick]\r\nHomeService.greet returns [class: java.lang.String]: Hi, mick\n"}]}],"\n",["$","p",null,{"children":"呢個就係 demo 緊我地點樣喺 service layer 被用到既時候，用 Spring AOP 黎 log 低 input 同 output。"}],"\n",["$","p",null,{"children":["同樣地，我地都可以針對 controller layer 或者 JPA 既 repository layer 去做一啲處理。我地只需要修改 ",["$","code",null,{"children":"@Around(\"execution(* code.xxxxxx.*.*(..))\")"}]," 既 package，就可以對呢個 package 裡面既所有 Spring components 做相同既處理。"]}],"\n",["$","p",null,{"children":["如果想寫一個 method 但係針對多過一個 package，咁我地可以用 ",["$","code",null,{"children":"||"}]," operator，將幾個 ",["$","code",null,{"children":"execution()"}]," 駁埋一齊："]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-java","children":"@Around(\r\n          \"execution(* code.controller.*.*(..))\"\r\n    + \" || execution(* code.service.*.*(..))\"\r\n)\r\npublic Object around(ProceedingJoinPoint joinPoint) throws Throwable {\r\n    // ...\r\n}\n"}]}]],null,["$","$L11",null,{"children":"$L12"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","3dqCRZzcx_POTxzEEe1Bo",{"children":[["$","$L13",null,{"children":"$L14"}],["$","$L15",null,{"children":"$L16"}],null]}]]}],false]],"m":"$undefined","G":["$17","$undefined"],"s":false,"S":true}
16:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
14:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Michael Chung's e-Portfolio"}],["$","meta","2",{"name":"description","content":"Powered by Next.js and React"}]]
12:null
