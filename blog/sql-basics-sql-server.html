<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/e2-next/_next/static/css/d3df112486f97f47.css" data-precedence="next"/><link rel="stylesheet" href="/e2-next/_next/static/css/c3624a693ae5a0c4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/e2-next/_next/static/chunks/webpack-f088da4552bcc253.js"/><script src="/e2-next/_next/static/chunks/4bd1b696-120f4d9c40d223dd.js" async=""></script><script src="/e2-next/_next/static/chunks/1517-c8d232d43a11224c.js" async=""></script><script src="/e2-next/_next/static/chunks/main-app-05c45cc8f30d6cea.js" async=""></script><script src="/e2-next/_next/static/chunks/7829-b7b9eb1dbe0d40e4.js" async=""></script><script src="/e2-next/_next/static/chunks/2153-45fd9844831c6348.js" async=""></script><script src="/e2-next/_next/static/chunks/app/layout-ea91c2d128ec48c2.js" async=""></script><script src="/e2-next/_next/static/chunks/app/page-c8b940db14fac9a0.js" async=""></script><title>Michael Chung&#x27;s e-Portfolio</title><meta name="description" content="Powered by Next.js and React"/><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"/><script src="/e2-next/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div class="vstack gap-5"><div class="text-center vstack gap-5"><div><code class="SiteHeader_name__cwQmL">Chung Cheuk Hang Michael</code><code class="SiteHeader_title__CCfvI">Java Web Developer</code></div><nav class="justify-content-center navbar navbar-expand-md navbar-dark"><button type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed"><span class="navbar-toggler-icon"></span></button><div class="justify-content-center navbar-collapse collapse"><div class="justify-content-center navbar-nav nav-underline"><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/" class="nav-link" href="/e2-next">Home</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/work" class="nav-link" href="/e2-next/work">Work</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/hobbyProjects" class="nav-link" href="/e2-next/hobbyProjects">Hobby projects</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/personality" class="nav-link" href="/e2-next/personality">Personality</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/blog" class="nav-link" href="/e2-next/blog">Blog</a></div></div></div></nav></div><h1>1 Table 相關語法</h1>
<h2>1.1 創建 table</h2>
<pre><code class="language-sql">CREATE TABLE tbl_person (
	entity_id  INT          IDENTITY(1, 1),
	name       VARCHAR(255) NOT NULL,
	email      VARCHAR(255) NOT NULL,
	created_at DATETIME     NOT NULL DEFAULT GETDATE(),
	updated_at DATETIME     NOT NULL DEFAULT GETDATE(),

	PRIMARY KEY (entity_id),
	CONSTRAINT UQ_person UNIQUE (email)
);
</code></pre>
<hr/>
<h2>1.2 刪除 table</h2>
<pre><code class="language-sql">DROP TABLE IF EXISTS tbl_person;
</code></pre>
<hr/>
<h2>1.3 新增紀錄</h2>
<pre><code class="language-sql">INSERT INTO tbl_person VALUES (&#x27;Alice&#x27;, &#x27;alice@gmail.com&#x27;, GETDATE(), GETDATE());
</code></pre>
<pre><code class="language-sql">INSERT INTO tbl_person (name, email) VALUES (&#x27;Bob&#x27;, &#x27;bob@gmail.com&#x27;);
</code></pre>
<p>註：</p>
<ul>
<li><code>IDENTITY</code> column 唔應該入，應該由 DB 自動生成。</li>
<li>如果 <code>VALUES</code> 前面有 column list，有 <code>DEFAULT</code> 既 columns 可以選擇明確提供或者唔提供，唔提供既話 DB 就會用左 <code>CREATE TABLE</code> 裡面 column definition 既 <code>DEFAULT</code>（例子中 <code>create_at</code> 既 default value 就係 built-in function <code>GETDATE()</code>）。</li>
</ul>
<hr/>
<h2>1.4 查詢紀錄</h2>
<h3>1.4.1 一般查詢</h3>
<pre><code class="language-sql">SELECT * FROM tbl_person;
</code></pre>
<pre><code class="language-sql">SELECT
	entity_id,
	name,
	email,
	created_at
FROM tbl_person
WHERE entity_id = 1;
</code></pre>
<p>Pagination（分頁）：</p>
<pre><code class="language-sql">SELECT *
FROM tbl_person
ORDER BY entity_id
OFFSET 1 ROWS
FETCH NEXT 1 ROWS ONLY; -- NEXT、FIRST 係同義
</code></pre>
<hr/>
<h3>1.4.2 多 tables 查詢</h3>
<p>同其他 table 連起黎：</p>
<pre><code class="language-sql">CREATE TABLE tbl_friend (
	entity_id        INT          IDENTITY(1, 1),
	person_entity_id INT          NOT NULL,
	name             VARCHAR(255) NOT NULL,

	PRIMARY KEY (entity_id),
	INDEX IX_friend (entity_id, person_entity_id)
);

INSERT INTO tbl_friend (person_entity_id, name) VALUES (1, &#x27;Mick&#x27;);

SELECT
	p.name,
	f.name
FROM
	tbl_person p,
	tbl_friend f
WHERE
	p.entity_id = f.person_entity_id
AND p.name = &#x27;Alice&#x27;
</code></pre>
<hr/>
<h3>1.4.3 帶鎖查詢</h3>
<p>如果同時有多過一個程式需要查詢然後更新同一行紀錄，我地可以用悲觀鎖。當兩個程式同時執行以下 SQL，只有一個程式可以立即查詢到相關紀錄，而另一個程式就會一直等待，直到攞到鎖既程式完成曬 transaction，咁佢先會攞到個鎖。</p>
<pre><code class="language-sql">BEGIN TRANSACTION;

SELECT *
FROM tbl_person
WITH (
	UPDLOCK,
	ROWLOCK
)
WHERE entity_id = 2;
</code></pre>
<p>如果 <code>WHERE</code> 裡面既條件唔係針對 primary key column 既 value，咁我地就要自己起 index，然後用 <code>WITH (UPDLOCK, INDEX(&lt;index name&gt;))</code>，否則 SQL Server 會鎖埋唔 match <code>WHERE</code> 條件既紀錄，更有可能鎖曬成個 table 既紀錄。</p>
<hr/>
<h2>1.5 刪除部分或所有紀錄</h2>
<p>以特定條件刪除 table 內紀錄：</p>
<pre><code class="language-sql">DELETE FROM tbl_person WHERE entity_id = 1;
</code></pre>
<p>刪除 table 內所有紀錄：</p>
<pre><code class="language-sql">DELETE FROM tbl_person;
</code></pre>
<p>註：</p>
<ul>
<li><code>DELETE</code> 係 DML 語句。<!-- -->
<ul>
<li>所以 <code>DELETE</code> 係可以喺 transaction 裡面執行，自然就可以 rollback。</li>
</ul>
</li>
</ul>
<hr/>
<h2>1.6 清空所有紀錄</h2>
<pre><code class="language-sql">TRUNCATE TABLE tbl_person;
</code></pre>
<p>註：</p>
<ul>
<li><code>TRUNCATE</code> 係 DDL 語句，有別於 <code>DELETE</code>。<!-- -->
<ul>
<li>所以 <code>TRUNCATE</code> 係唔可以喺 transaction 裡面執行，自然就唔可以 rollback。</li>
<li><code>TRUNCATE</code> 所產生既 transaction log 會遠少過 <code>DELETE</code>。</li>
</ul>
</li>
<li><code>TRUNCATE</code> 唔會觸發 trigger。</li>
</ul>
<hr/>
<h1>2 Sequence 相關語法</h1>
<h2>2.1 創建 sequence</h2>
<pre><code class="language-sql">CREATE SEQUENCE seq_generator START WITH 1000 MINVALUE 1000 MAXVALUE 9999 CYCLE;
</code></pre>
<hr/>
<h2>2.2 更改 sequence</h2>
<pre><code class="language-sql">ALTER SEQUENCE seq_generator RESTART WITH 2000;
</code></pre>
<hr/>
<h2>2.3 獲取下一個 sequence value</h2>
<pre><code class="language-sql">SELECT NEXT VALUE FOR seq_generator;
</code></pre>
<hr/>
<h1>3 Trigger 相關語法</h1>
<h2>3.1 創建或更新 trigger</h2>
<h3>3.1.1 由更新紀錄觸發</h3>
<pre><code class="language-sql">CREATE OR ALTER TRIGGER trg_person
ON tbl_person
FOR UPDATE AS
BEGIN
	UPDATE p
	SET updated_at = GETDATE()
	FROM tbl_person p, inserted
	WHERE p.entity_id = inserted.entity_id
END;
GO
</code></pre>
<p>解釋：當 <code>tbl_person</code> 既紀錄被更新，將會觸發呢個 trigger 去更新相關紀錄既 <code>updated_at</code> column 做當前系統時間。</p>
<hr/>
<h1>4 其他語法</h1>
<h2>4.1 執行動態 SQL</h2>
<p>如果 table 名、 column 名等 SQL 元素需要動態 values，咁就要用呢個方法：</p>
<pre><code class="language-sql">-- 假設 values 從某個 table 取得
DECLARE @columns VARCHAR(100) = &#x27;name, email&#x27;;
DECLARE @tableName VARCHAR(100) = &#x27;tbl_person&#x27;;

EXEC(&#x27;SELECT &#x27; + @columns + &#x27; FROM &#x27; + @tableName);
</code></pre>
<hr/>
<h1>5 查詢系統 tables</h1>
<h2>5.1 查詢 table list</h2>
<pre><code class="language-sql">SELECT * FROM sys.tables;
</code></pre>
<hr/>
<h2>5.2 查詢 table 既 column 結構</h2>
<pre><code class="language-sql">SELECT
    CAST(c.name AS VARCHAR) columnName,
    CAST(typ.name AS VARCHAR) dataType,
    c.max_length maxLength,
    c.precision,
    c.scale
FROM
    sys.all_columns c,
    sys.tables tbl,
    sys.types typ
WHERE
    c.object_id = tbl.object_id
AND c.system_type_id = typ.system_type_id
AND tbl.name = &#x27;table_name&#x27;
ORDER BY c.column_id;
</code></pre>
<hr/>
<h1>6 查看 SQL execution plan、index 使用情況（優化 SQL 用）</h1>
<p>SQL Server 冇 MySQL／MariaDB 既 <code>EXPLAIN</code>，只能透通過 SQL Server Management Studio（SSMS）黎睇 estimated execution plan 以及 actual execution plan。</p>
<p>喺 SSMS：</p>
<ul>
<li>顯示 estimated execution plan<!-- -->
<ol>
<li>Highlight 然後 right-click 句 SQL</li>
<li>撳 <strong>Display Estimated Execution Plan</strong></li>
<li>佢會顯示 execution plan</li>
</ol>
</li>
<li>顯示 actual execution plan<!-- -->
<ol>
<li>Right-click 輸入 SQL query 既任何空白位置</li>
<li>撳 <strong>Include Actual Execution Plan</strong></li>
<li>每當 execute 一句 SQL，佢就會顯示 execution plan</li>
</ol>
</li>
</ul>
<p>Execution plan 應該會包含 <code>2</code> 個或以上既圖示，我地可以用 mouse hover 啲圖示睇下佢頭頂寫咩。好籠統咁講：</p>
<ul>
<li>如果圖示有 index seek 字眼就會用上 index</li>
<li>如果圖示有 index scan 或者 table scan 字眼就唔會用上 index。</li>
</ul>
<p>非專業見解：</p>
<ul>
<li>Index seek 比 index scan 或者 table scan 效能要好。</li>
<li><code>SELECT *</code>
<ul>
<li>如果令 query result 既 columns 包括左個 table 定義既 indexes 冇既 columns，咁佢個 execution plan 右邊可能會出現 <code>2</code> 個步驟（<code>3</code> 個或以上既圖示），可以係 index seek 完再 RID lookup 或者 key lookup，不過實際情況要視乎個 table schema／definition。</li>
</ul>
</li>
<li><code>LIKE</code>
<ul>
<li>如果 <code>WHERE</code> clause 係對 <code>VARCHAR</code> column 用 <code>LIKE &#x27;xxx%&#x27;</code>，應該可以用到 index seek。</li>
<li>如果 <code>WHERE</code> clause 係對 <code>VARCHAR</code> column 用 <code>LIKE &#x27;%xxx&#x27;</code> 或者 <code>LIKE &#x27;%xxx%&#x27;</code>，就用唔到 index seek。</li>
</ul>
</li>
<li>Type conversion<!-- -->
<ul>
<li>如果 <code>WHERE</code> clause 對 <code>INT</code> column 用 <code>LIKE &#x27;1%&#x27;</code>，就用唔到 index seek，而 execution plan 既 SELECT 圖示會顯示黃色三角形以及關於 type conversion 既 warning。</li>
</ul>
</li>
<li><code>WITH (FORCESEEK)</code>
<ul>
<li>呢個 hint 可以令 <code>1</code> 個 scan 既步驟拆開成 <code>2</code> 個步驟——seek 以及 lookup。</li>
<li><code>SELECT email FROM tbl_person WITH (FORCESEEK) WHERE email LIKE &#x27;xxx%&#x27;;</code></li>
</ul>
</li>
</ul>
<p>參考資料：</p>
<ul>
<li><a href="https://mattsql.wordpress.com/2013/05/22/wildcards-and-indexes/">Wildcards and Indexes</a></li>
<li><a href="https://www.brentozar.com/archive/2010/06/sargable-why-string-is-slow/">Sargability: Why %string% Is Slow</a></li>
<li><a href="https://blog.darkthread.net/blog/index-scan-vs-seek/">SQL 筆記：Index Scan vs Index Seek</a></li>
<li><a href="https://use-the-index-luke.com/blog/2013-08/its-not-about-the-star-stupid">Myth: Select * is bad</a></li>
<li><a href="https://stackoverflow.com/questions/5447987/why-cant-i-simply-add-an-index-that-includes-all-columns">StackOverflow - Why can&#x27;t I simply add an index that includes all columns?</a></li>
</ul><hr/><div class="vstack gap-3"><div class="text-center container"><div class="justify-content-center g-3 row row-cols-md-3 row-cols-sm-2 row-cols-1"><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="tel:+85263301333"><div class="card-body"><div class="card-title h5"><i class="fa-solid fa-phone" style="color:#009688"></i></div><p class="text-muted card-text">6330 1333<!-- --> </p></div></a></div><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="mailto:michaelboyboy@gmail.com"><div class="card-body"><div class="card-title h5"><i class="fa-solid fa-envelope" style="color:#f44336"></i></div><p class="text-muted card-text">michaelboyboy@gmail.com<!-- --> </p></div></a></div><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="https://www.linkedin.com/in/mickchung"><div class="card-body"><div class="card-title h5"><i class="fa-brands fa-linkedin" style="color:#2196f3"></i></div><p class="text-muted card-text">www.linkedin.com/in/mickchung<!-- --> </p></div></a></div></div></div></div></div><script src="/e2-next/_next/static/chunks/webpack-f088da4552bcc253.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[8287,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\n3:I[3339,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n4:I[1367,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\n5:I[5244,[],\"\"]\n6:I[3866,[],\"\"]\n7:I[4798,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n8:I[6121,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n9:I[3667,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\na:I[8407,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nb:I[8173,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"\"]\nc:I[3197,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nd:I[7933,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\ne:I[3800,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nf:I[6213,[],\"OutletBoundary\"]\n11:I[6213,[],\"MetadataBoundary\"]\n13:I[6213,[],\"ViewportBoundary\"]\n15:I[4835,[],\"\"]\n:HL[\"/e2-next/_next/static/css/d3df112486f97f47.css\",\"style\"]\n:HL[\"/e2-next/_next/static/css/c3624a693ae5a0c4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"wfZ4FdS4ntgGvzjeKJhfw\",\"p\":\"/e2-next\",\"c\":[\"\",\"blog\",\"sql-basics-sql-server\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[\"(2021-08)\",{\"children\":[\"sql-basics-sql-server\",{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/e2-next/_next/static/css/d3df112486f97f47.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/e2-next/_next/static/css/c3624a693ae5a0c4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css\"}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"gap\":5,\"children\":[[\"$\",\"$L3\",null,{\"gap\":5,\"className\":\"text-center\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"code\",null,{\"className\":\"SiteHeader_name__cwQmL\",\"children\":\"Chung Cheuk Hang Michael\"}],[\"$\",\"code\",null,{\"className\":\"SiteHeader_title__CCfvI\",\"children\":\"Java Web Developer\"}]]}],[\"$\",\"$L4\",null,{}]]}],[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"hr\",null,{}],[\"$\",\"$L3\",null,{\"gap\":3,\"children\":[\"$\",\"$L7\",null,{\"className\":\"text-center\",\"children\":[\"$\",\"$L8\",null,{\"xs\":1,\"sm\":2,\"md\":3,\"className\":\"justify-content-center g-3\",\"children\":[[\"$\",\"$L9\",\"0\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"tel:+85263301333\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-solid fa-phone\",\"style\":{\"color\":\"#009688\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"6330 1333\",\" \"]}]]}]}]}],[\"$\",\"$L9\",\"1\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"mailto:michaelboyboy@gmail.com\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-solid fa-envelope\",\"style\":{\"color\":\"#f44336\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"michaelboyboy@gmail.com\",\" \"]}]]}]}]}],[\"$\",\"$L9\",\"2\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"https://www.linkedin.com/in/mickchung\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-brands fa-linkedin\",\"style\":{\"color\":\"#2196f3\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"www.linkedin.com/in/mickchung\",\" \"]}]]}]}]}]]}]}]}]]}]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"(2021-08)\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"(2021-08)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"sql-basics-sql-server\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"(2021-08)\",\"children\",\"sql-basics-sql-server\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"h1\",null,{\"children\":\"1 Table 相關語法\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"1.1 創建 table\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"CREATE TABLE tbl_person (\\r\\n\\tentity_id  INT          IDENTITY(1, 1),\\r\\n\\tname       VARCHAR(255) NOT NULL,\\r\\n\\temail      VARCHAR(255) NOT NULL,\\r\\n\\tcreated_at DATETIME     NOT NULL DEFAULT GETDATE(),\\r\\n\\tupdated_at DATETIME     NOT NULL DEFAULT GETDATE(),\\r\\n\\r\\n\\tPRIMARY KEY (entity_id),\\r\\n\\tCONSTRAINT UQ_person UNIQUE (email)\\r\\n);\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"1.2 刪除 table\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"DROP TABLE IF EXISTS tbl_person;\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"1.3 新增紀錄\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"INSERT INTO tbl_person VALUES ('Alice', 'alice@gmail.com', GETDATE(), GETDATE());\\n\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"INSERT INTO tbl_person (name, email) VALUES ('Bob', 'bob@gmail.com');\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"註：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"IDENTITY\"}],\" column 唔應該入，應該由 DB 自動生成。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果 \",[\"$\",\"code\",null,{\"children\":\"VALUES\"}],\" 前面有 column list，有 \",[\"$\",\"code\",null,{\"children\":\"DEFAULT\"}],\" 既 columns 可以選擇明確提供或者唔提供，唔提供既話 DB 就會用左 \",[\"$\",\"code\",null,{\"children\":\"CREATE TABLE\"}],\" 裡面 column definition 既 \",[\"$\",\"code\",null,{\"children\":\"DEFAULT\"}],\"（例子中 \",[\"$\",\"code\",null,{\"children\":\"create_at\"}],\" 既 default value 就係 built-in function \",[\"$\",\"code\",null,{\"children\":\"GETDATE()\"}],\"）。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"1.4 查詢紀錄\"}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"1.4.1 一般查詢\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"SELECT * FROM tbl_person;\\n\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"SELECT\\r\\n\\tentity_id,\\r\\n\\tname,\\r\\n\\temail,\\r\\n\\tcreated_at\\r\\nFROM tbl_person\\r\\nWHERE entity_id = 1;\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Pagination（分頁）：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"SELECT *\\r\\nFROM tbl_person\\r\\nORDER BY entity_id\\r\\nOFFSET 1 ROWS\\r\\nFETCH NEXT 1 ROWS ONLY; -- NEXT、FIRST 係同義\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"1.4.2 多 tables 查詢\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"同其他 table 連起黎：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"CREATE TABLE tbl_friend (\\r\\n\\tentity_id        INT          IDENTITY(1, 1),\\r\\n\\tperson_entity_id INT          NOT NULL,\\r\\n\\tname             VARCHAR(255) NOT NULL,\\r\\n\\r\\n\\tPRIMARY KEY (entity_id),\\r\\n\\tINDEX IX_friend (entity_id, person_entity_id)\\r\\n);\\r\\n\\r\\nINSERT INTO tbl_friend (person_entity_id, name) VALUES (1, 'Mick');\\r\\n\\r\\nSELECT\\r\\n\\tp.name,\\r\\n\\tf.name\\r\\nFROM\\r\\n\\ttbl_person p,\\r\\n\\ttbl_friend f\\r\\nWHERE\\r\\n\\tp.entity_id = f.person_entity_id\\r\\nAND p.name = 'Alice'\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"1.4.3 帶鎖查詢\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"如果同時有多過一個程式需要查詢然後更新同一行紀錄，我地可以用悲觀鎖。當兩個程式同時執行以下 SQL，只有一個程式可以立即查詢到相關紀錄，而另一個程式就會一直等待，直到攞到鎖既程式完成曬 transaction，咁佢先會攞到個鎖。\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"BEGIN TRANSACTION;\\r\\n\\r\\nSELECT *\\r\\nFROM tbl_person\\r\\nWITH (\\r\\n\\tUPDLOCK,\\r\\n\\tROWLOCK\\r\\n)\\r\\nWHERE entity_id = 2;\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"如果 \",[\"$\",\"code\",null,{\"children\":\"WHERE\"}],\" 裡面既條件唔係針對 primary key column 既 value，咁我地就要自己起 index，然後用 \",[\"$\",\"code\",null,{\"children\":\"WITH (UPDLOCK, INDEX(\u003cindex name\u003e))\"}],\"，否則 SQL Server 會鎖埋唔 match \",[\"$\",\"code\",null,{\"children\":\"WHERE\"}],\" 條件既紀錄，更有可能鎖曬成個 table 既紀錄。\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"1.5 刪除部分或所有紀錄\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"以特定條件刪除 table 內紀錄：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"DELETE FROM tbl_person WHERE entity_id = 1;\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"刪除 table 內所有紀錄：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"DELETE FROM tbl_person;\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"註：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"DELETE\"}],\" 係 DML 語句。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"所以 \",[\"$\",\"code\",null,{\"children\":\"DELETE\"}],\" 係可以喺 transaction 裡面執行，自然就可以 rollback。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"1.6 清空所有紀錄\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"TRUNCATE TABLE tbl_person;\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"註：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"TRUNCATE\"}],\" 係 DDL 語句，有別於 \",[\"$\",\"code\",null,{\"children\":\"DELETE\"}],\"。\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"所以 \",[\"$\",\"code\",null,{\"children\":\"TRUNCATE\"}],\" 係唔可以喺 transaction 裡面執行，自然就唔可以 rollback。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"TRUNCATE\"}],\" 所產生既 transaction log 會遠少過 \",[\"$\",\"code\",null,{\"children\":\"DELETE\"}],\"。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"TRUNCATE\"}],\" 唔會觸發 trigger。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"2 Sequence 相關語法\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"2.1 創建 sequence\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"CREATE SEQUENCE seq_generator START WITH 1000 MINVALUE 1000 MAXVALUE 9999 CYCLE;\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"2.2 更改 sequence\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"ALTER SEQUENCE seq_generator RESTART WITH 2000;\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"2.3 獲取下一個 sequence value\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"SELECT NEXT VALUE FOR seq_generator;\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"3 Trigger 相關語法\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.1 創建或更新 trigger\"}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"3.1.1 由更新紀錄觸發\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"CREATE OR ALTER TRIGGER trg_person\\r\\nON tbl_person\\r\\nFOR UPDATE AS\\r\\nBEGIN\\r\\n\\tUPDATE p\\r\\n\\tSET updated_at = GETDATE()\\r\\n\\tFROM tbl_person p, inserted\\r\\n\\tWHERE p.entity_id = inserted.entity_id\\r\\nEND;\\r\\nGO\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"解釋：當 \",[\"$\",\"code\",null,{\"children\":\"tbl_person\"}],\" 既紀錄被更新，將會觸發呢個 trigger 去更新相關紀錄既 \",[\"$\",\"code\",null,{\"children\":\"updated_at\"}],\" column 做當前系統時間。\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"4 其他語法\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"4.1 執行動態 SQL\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"如果 table 名、 column 名等 SQL 元素需要動態 values，咁就要用呢個方法：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"-- 假設 values 從某個 table 取得\\r\\nDECLARE @columns VARCHAR(100) = 'name, email';\\r\\nDECLARE @tableName VARCHAR(100) = 'tbl_person';\\r\\n\\r\\nEXEC('SELECT ' + @columns + ' FROM ' + @tableName);\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"5 查詢系統 tables\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"5.1 查詢 table list\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"SELECT * FROM sys.tables;\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"5.2 查詢 table 既 column 結構\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-sql\",\"children\":\"SELECT\\r\\n    CAST(c.name AS VARCHAR) columnName,\\r\\n    CAST(typ.name AS VARCHAR) dataType,\\r\\n    c.max_length maxLength,\\r\\n    c.precision,\\r\\n    c.scale\\r\\nFROM\\r\\n    sys.all_columns c,\\r\\n    sys.tables tbl,\\r\\n    sys.types typ\\r\\nWHERE\\r\\n    c.object_id = tbl.object_id\\r\\nAND c.system_type_id = typ.system_type_id\\r\\nAND tbl.name = 'table_name'\\r\\nORDER BY c.column_id;\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"6 查看 SQL execution plan、index 使用情況（優化 SQL 用）\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"SQL Server 冇 MySQL／MariaDB 既 \",[\"$\",\"code\",null,{\"children\":\"EXPLAIN\"}],\"，只能透通過 SQL Server Management Studio（SSMS）黎睇 estimated execution plan 以及 actual execution plan。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"喺 SSMS：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"顯示 estimated execution plan\",\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Highlight 然後 right-click 句 SQL\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"撳 \",[\"$\",\"strong\",null,{\"children\":\"Display Estimated Execution Plan\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"佢會顯示 execution plan\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"顯示 actual execution plan\",\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Right-click 輸入 SQL query 既任何空白位置\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"撳 \",[\"$\",\"strong\",null,{\"children\":\"Include Actual Execution Plan\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"每當 execute 一句 SQL，佢就會顯示 execution plan\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Execution plan 應該會包含 \",[\"$\",\"code\",null,{\"children\":\"2\"}],\" 個或以上既圖示，我地可以用 mouse hover 啲圖示睇下佢頭頂寫咩。好籠統咁講：\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"如果圖示有 index seek 字眼就會用上 index\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"如果圖示有 index scan 或者 table scan 字眼就唔會用上 index。\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"非專業見解：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Index seek 比 index scan 或者 table scan 效能要好。\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"SELECT *\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果令 query result 既 columns 包括左個 table 定義既 indexes 冇既 columns，咁佢個 execution plan 右邊可能會出現 \",[\"$\",\"code\",null,{\"children\":\"2\"}],\" 個步驟（\",[\"$\",\"code\",null,{\"children\":\"3\"}],\" 個或以上既圖示），可以係 index seek 完再 RID lookup 或者 key lookup，不過實際情況要視乎個 table schema／definition。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"LIKE\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果 \",[\"$\",\"code\",null,{\"children\":\"WHERE\"}],\" clause 係對 \",[\"$\",\"code\",null,{\"children\":\"VARCHAR\"}],\" column 用 \",[\"$\",\"code\",null,{\"children\":\"LIKE 'xxx%'\"}],\"，應該可以用到 index seek。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果 \",[\"$\",\"code\",null,{\"children\":\"WHERE\"}],\" clause 係對 \",[\"$\",\"code\",null,{\"children\":\"VARCHAR\"}],\" column 用 \",[\"$\",\"code\",null,{\"children\":\"LIKE '%xxx'\"}],\" 或者 \",[\"$\",\"code\",null,{\"children\":\"LIKE '%xxx%'\"}],\"，就用唔到 index seek。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Type conversion\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"如果 \",[\"$\",\"code\",null,{\"children\":\"WHERE\"}],\" clause 對 \",[\"$\",\"code\",null,{\"children\":\"INT\"}],\" column 用 \",[\"$\",\"code\",null,{\"children\":\"LIKE '1%'\"}],\"，就用唔到 index seek，而 execution plan 既 SELECT 圖示會顯示黃色三角形以及關於 type conversion 既 warning。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"WITH (FORCESEEK)\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"呢個 hint 可以令 \",[\"$\",\"code\",null,{\"children\":\"1\"}],\" 個 scan 既步驟拆開成 \",[\"$\",\"code\",null,{\"children\":\"2\"}],\" 個步驟——seek 以及 lookup。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"SELECT email FROM tbl_person WITH (FORCESEEK) WHERE email LIKE 'xxx%';\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"參考資料：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://mattsql.wordpress.com/2013/05/22/wildcards-and-indexes/\",\"children\":\"Wildcards and Indexes\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.brentozar.com/archive/2010/06/sargable-why-string-is-slow/\",\"children\":\"Sargability: Why %string% Is Slow\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://blog.darkthread.net/blog/index-scan-vs-seek/\",\"children\":\"SQL 筆記：Index Scan vs Index Seek\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://use-the-index-luke.com/blog/2013-08/its-not-about-the-star-stupid\",\"children\":\"Myth: Select * is bad\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://stackoverflow.com/questions/5447987/why-cant-i-simply-add-an-index-that-includes-all-columns\",\"children\":\"StackOverflow - Why can't I simply add an index that includes all columns?\"}]}],\"\\n\"]}]],null,[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"0ZbL-3CYN8WXqDrmlG0sM\",{\"children\":[[\"$\",\"$L11\",null,{\"children\":\"$L12\"}],[\"$\",\"$L13\",null,{\"children\":\"$L14\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$15\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"14:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n12:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Michael Chung's e-Portfolio\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Powered by Next.js and React\"}]]\n"])</script><script>self.__next_f.push([1,"10:null\n"])</script></body></html>