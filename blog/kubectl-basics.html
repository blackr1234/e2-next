<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/e2-next/_next/static/css/d3df112486f97f47.css" data-precedence="next"/><link rel="stylesheet" href="/e2-next/_next/static/css/c3624a693ae5a0c4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/e2-next/_next/static/chunks/webpack-f088da4552bcc253.js"/><script src="/e2-next/_next/static/chunks/4bd1b696-120f4d9c40d223dd.js" async=""></script><script src="/e2-next/_next/static/chunks/1517-c8d232d43a11224c.js" async=""></script><script src="/e2-next/_next/static/chunks/main-app-05c45cc8f30d6cea.js" async=""></script><script src="/e2-next/_next/static/chunks/7829-b7b9eb1dbe0d40e4.js" async=""></script><script src="/e2-next/_next/static/chunks/2153-45fd9844831c6348.js" async=""></script><script src="/e2-next/_next/static/chunks/app/layout-ea91c2d128ec48c2.js" async=""></script><script src="/e2-next/_next/static/chunks/app/page-c8b940db14fac9a0.js" async=""></script><title>Michael Chung&#x27;s e-Portfolio</title><meta name="description" content="Powered by Next.js and React"/><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"/><script src="/e2-next/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div class="vstack gap-5"><div class="text-center vstack gap-5"><div><code class="SiteHeader_name__cwQmL">Chung Cheuk Hang Michael</code><code class="SiteHeader_title__CCfvI">Java Web Developer</code></div><nav class="justify-content-center navbar navbar-expand-md navbar-dark"><button type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed"><span class="navbar-toggler-icon"></span></button><div class="justify-content-center navbar-collapse collapse"><div class="justify-content-center navbar-nav nav-underline"><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/" class="nav-link" href="/e2-next">Home</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/work" class="nav-link" href="/e2-next/work">Work</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/hobbyProjects" class="nav-link" href="/e2-next/hobbyProjects">Hobby projects</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/personality" class="nav-link" href="/e2-next/personality">Personality</a></div><div class="nav-item"><a draggable="false" data-rr-ui-event-key="/blog" class="nav-link" href="/e2-next/blog">Blog</a></div></div></div></nav></div><h1>1 kubectl 介紹</h1>
<p><code>kubectl</code> 係一個用黎操作雲端 K8s clusters 既 K8s 資源既一個 CLI 工具。</p>
<hr/>
<h1>2 登入 K8s cluster</h1>
<p>用之前需要先成功登入 K8s cluster，拎到 client certificate、client key、token 等等既 data，之後就可以操作佢上面既 K8s 資源。</p>
<p>呢啲 data 儲存喺 <code>C:/Users/&lt;username&gt;/.kube/config</code> 裡面。</p>
<p>我地可以登入多個 K8s clusters，然後喺佢地之間 switch 黎 switch 去。</p>
<h2>2.1 本地開發環境：Docker Desktop</h2>
<p>如果係喺本地開發環境，直接喺 Docker Desktop 度 enable Kubernetes 就唔洗額外登入。</p>
<hr/>
<h2>2.2 本地開發環境：Minikube</h2>
<p>如果係喺本地開發環境，直接用 Minikube 就唔洗額外登入。</p>
<hr/>
<h2>2.3 登入 Azure Kubernetes Service（AKS）</h2>
<p>如果係用 AKS，就要用 Azure CLI 登入：</p>
<pre><code class="language-bash">az login -u &lt;email&gt;
az aks get-credentials -n &lt;cluster name&gt; -g &lt;resource group&gt; --admin --overwrite-existing
</code></pre>
<hr/>
<h1>3 kubectl 指令</h1>
<h2>3.1 切換 cluster</h2>
<pre><code class="language-bash">kubectl config use-context &lt;context name&gt;
</code></pre>
<hr/>
<h2>3.2 查看目前 cluster</h2>
<p>我地可以睇到已經登入左既 cluster、佢既 context name、目前既默認 namespace，以及目前既 cluster（打左星號 <code>*</code>）：</p>
<pre><code class="language-bash">kubectl config get-contexts
</code></pre>
<hr/>
<h2>3.3 切換默認 namespace</h2>
<pre><code class="language-bash">kubectl config set-context --current --namespace=&lt;namespace&gt;
</code></pre>
<p>如果唔先切換去目標 namespace，而目標 namespace 同現時默認既 namespace 唔同既話，咁就要喺每個 <code>kubectl</code> command 都用 <code>-n &lt;namespace&gt;</code> option 去指定目標 namespace。</p>
<hr/>
<h2>3.4 列出所有 K8s 資源種類</h2>
<pre><code class="language-bash">kubectl api-resources -o wide
</code></pre>
<hr/>
<h2>3.5 列出某種類既 K8s 資源</h2>
<pre><code class="language-bash">kubectl get &lt;resource type&gt;
</code></pre>
<h3>3.5.1 <code>Pod</code></h3>
<p>睇 pod name、幾多個 containers 已經 ready、status、create 左幾耐：</p>
<pre><code class="language-bash">kubectl get pods
</code></pre>
<hr/>
<h3>3.5.2 <code>Deployment</code></h3>
<pre><code class="language-bash">kubectl get deployments
</code></pre>
<hr/>
<h3>3.5.3 <code>ReplicaSet</code></h3>
<pre><code class="language-bash">kubectl get replicasets
</code></pre>
<hr/>
<h3>3.5.4 <code>HorizontalPodAutoscaler</code></h3>
<pre><code class="language-bash">kubectl get horizontalpodautoscalers
</code></pre>
<hr/>
<h3>3.5.5 <code>AuthorizationPolicy</code></h3>
<pre><code class="language-bash">kubectl get authorizationpolicys
</code></pre>
<hr/>
<h3>3.5.6 <code>Service</code></h3>
<pre><code class="language-bash">kubectl get services
</code></pre>
<hr/>
<h3>3.5.7 <code>VirtualService</code></h3>
<pre><code class="language-bash">kubectl get virtualservices
</code></pre>
<hr/>
<h3>3.5.8 <code>DestinationRule</code></h3>
<pre><code class="language-bash">kubectl get destinationrules
</code></pre>
<hr/>
<h3>3.5.9 <code>ServiceAccount</code></h3>
<pre><code class="language-bash">kubectl get serviceaccounts
</code></pre>
<hr/>
<h3>3.5.10 <code>Event</code></h3>
<pre><code class="language-bash">kubectl get events
</code></pre>
<hr/>
<h3>3.5.11 <code>Node</code></h3>
<p>睇 nodes 同埋佢地既 container runtime 版本（<code>containerd</code> 或者 <code>docker</code>）：</p>
<pre><code class="language-bash">kubectl get nodes -o wide
</code></pre>
<hr/>
<h2>3.6 檢視 K8s 資源內容</h2>
<p>用 <code>get</code> 列出某種類既所有 K8s 資源之後，我地會見到個別 K8s 資源既名，然後就可以呢啲名黎 reference 個別 K8s 資源。</p>
<p>睇重要既 fields：</p>
<pre><code class="language-bash">kubectl describe &lt;resource type&gt; &lt;resource name&gt;
</code></pre>
<p>睇曬所有 fields：</p>
<pre><code class="language-bash">kubectl get &lt;resource type&gt; &lt;resource name&gt; -o yaml
</code></pre>
<p>比較常需要檢視既 K8s 資源有 <code>Pod</code> 以及 <code>Deployment</code>，因為：</p>
<ul>
<li><code>Pod</code> 既內容可以話畀我地知而家個 microservice 用咩參數黎運行，例如 Image ID、env、args、requests、limits，可以幫助我地 troubleshoot 問題。</li>
<li><code>Deployment</code> 定義左 pod template，係生成 <code>Pod</code> 既範本，修改佢之後 rollout restart 或者 delete <code>Pod</code> 就可以避免重新部署個 microservice。</li>
</ul>
<hr/>
<h2>3.7 修改 K8s 資源內容</h2>
<pre><code class="language-bash">kubectl edit &lt;resource type&gt; &lt;resource name&gt;
</code></pre>
<p>執行之後，會自動彈出 Notepad，修改完之後喺 Notepad 度 save，之後退出 Notepad，就會見到返回修改完成既回應。</p>
<hr/>
<h2>3.8 刪除 K8s 資源</h2>
<pre><code class="language-bash">kubectl delete &lt;resource type&gt; &lt;resource name&gt;
</code></pre>
<p><code>Pod</code> 算係比較常需要刪除既 K8s 資源，因為：</p>
<ul>
<li>為左加快開發，我地會想即時改變 microservice 既執行參數，但係因為 <code>Pod</code> 裡面既 microservice 已經運行緊，就咁修改 <code>Pod</code> 唔會起到作用，所以就要修改 <code>Deployment</code> 既 pod template，然後刪除運行緊既 <code>Pod</code>，等 K8s 自動生成 <code>Pod</code> 黎滿足 <code>ReplicaSet</code> 要求既 <code>Pod</code> 數量。</li>
</ul>
<hr/>
<h2>3.9 查看 <code>Pod</code> 日誌</h2>
<pre><code class="language-bash">kubectl logs &lt;pod name&gt;
</code></pre>
<p>Follow logs（佢會一直咁 stream logs 去我地個 console）：</p>
<pre><code class="language-bash">kubectl logs -f &lt;pod name&gt;
</code></pre>
<p>睇最後 <code>20</code> 行 logs，並且繼續 follow：</p>
<pre><code class="language-bash">kubectl logs -f &lt;pod name&gt; --tail=20
</code></pre>
<p>儲存喺檔案度（視乎 K8s 會為 <code>Pod</code> keep 幾多 logs，有上限）：</p>
<pre><code class="language-bash">kubectl logs &lt;pod name&gt; &gt; logs.txt
</code></pre>
<hr/>
<h2>3.10 Port-forward</h2>
<h3>3.10.1 Port-forward <code>Pod</code></h3>
<p>我地部署左一個 web microservice 上 K8s 之後，當個 <code>Pod</code> 成功運行緊，我地就可以試下佢既 HTTP API 功能。</p>
<p>其中一個方式就係直接訪問個 <code>Pod</code>，呢個時候就需要用到 <code>port-forward</code>。</p>
<pre><code class="language-bash">kubectl port-forward &lt;pod name&gt; &lt;port&gt;
kubectl port-forward &lt;pod name&gt; &lt;local port&gt;:&lt;remote port&gt;
</code></pre>
<p>例子一：假如個 <code>Pod</code> expose 緊 <code>8080</code>，而我地又想 local port 同 remote port 用埋同一個：</p>
<pre><code class="language-bash">kubectl port-forward &lt;pod name&gt; 8080
</code></pre>
<p>之後我地可以：</p>
<pre><code class="language-bash">curl localhost:8080
</code></pre>
<p>例子二：假如個 <code>Pod</code> expose 緊 <code>8080</code>，而我地又想 local port 用另一個，例如係 <code>8081</code>：</p>
<pre><code class="language-bash">kubectl port-forward &lt;pod name&gt; 8081:8080
</code></pre>
<p>之後我地可以：</p>
<pre><code class="language-bash">curl localhost:8081
</code></pre>
<hr/>
<h3>3.10.2 Port-forward <code>Service</code></h3>
<p>同樣地，我地都可以 port-forward <code>Service</code>：</p>
<pre><code class="language-bash">kubectl port-forward service/&lt;service name&gt; &lt;port&gt;
kubectl port-forward service/&lt;service name&gt; &lt;local port&gt;:&lt;remote port&gt;
</code></pre>
<hr/>
<h3>3.10.3 Port-forward <code>Deployment</code></h3>
<p>同樣地，我地都可以 port-forward <code>Deployment</code>：</p>
<pre><code class="language-bash">kubectl port-forward deployment/&lt;deployment name&gt; &lt;port&gt;
kubectl port-forward deployment/&lt;deployment name&gt; &lt;local port&gt;:&lt;remote port&gt;
</code></pre>
<hr/>
<h2>3.11 Scale up/down <code>Deployment</code></h2>
<p>手動增加或者減少 <code>Deployment</code> 既 <code>Pod</code> 數量：</p>
<pre><code class="language-bash">kubectl scale --replicas=&lt;new replica count&gt; deployment &lt;deployment name&gt;
</code></pre>
<p>註：如果有用緊 <code>HorizontalPodAutoscaler</code>，因為佢會控制 replicas 既數量，所以手動 scale up、scale down 係唔會 work，除非我地完全 scale down 到 <code>0</code> 或者刪除左個 <code>HorizontalPodAutoscaler</code>。</p>
<hr/>
<h2>3.12 重新部署 <code>Deployment</code></h2>
<p>想重新部署 <code>Pod</code> 但唔想有 downtime 既話，可以 restart <code>Deployment</code>：</p>
<pre><code class="language-bash">kubectl rollout restart deployment &lt;deployment name&gt;
</code></pre>
<p>K8s 會逐一將而家相同數量既 <code>Pod</code> 重新部署：</p>
<ol>
<li>先部署新既 <code>Pod</code>。</li>
<li>等新既 <code>Pod</code> ready（probes 成功）。</li>
<li>移除舊既 <code>Pod</code>。</li>
<li>重複以上步驟直至新既 <code>Pod</code> 取代曬所有舊既 <code>Pod</code>。</li>
</ol>
<hr/>
<h2>3.13 對 <code>Pod</code> 裡面既 container 執行指令</h2>
<p>有時如果需要檢視 container 裡面既檔案，或者執行一啲指令，都可以做到：</p>
<pre><code class="language-bash">kubectl exec -it -c &lt;container&gt; &lt;pod name&gt; -- /bin/bash
kubectl exec -it -c &lt;container&gt; &lt;pod name&gt; -- sh
</code></pre>
<p>場景：</p>
<ul>
<li>執行 <code>ls -l</code> 以及 <code>cat &lt;filename&gt;</code> 去睇下有咩檔案，以及個別檔案內容。</li>
<li>執行 <code>java -version</code> 去了解 Java microservice 既 Java 版本。</li>
</ul>
<hr/>
<h2>3.14 查看某種類 K8s 資源既資源使用情況</h2>
<p>呢度既「資源使用情況」係指 CPU、memory、storage。</p>
<pre><code class="language-bash">kubectl top &lt;resource type&gt;
</code></pre>
<hr/>
<h2>3.15 部署 K8s 資源</h2>
<p>根據檔案內容而部署或者更新 K8s resources：</p>
<pre><code class="language-bash">kubectl apply -f path/to/file.yml
</code></pre>
<p>根據檔案內容而刪除 K8s resources：</p>
<pre><code class="language-bash">kubectl delete -f path/to/file.yml
</code></pre>
<hr/>
<h2>3.16 從 K8s container 抄出檔案</h2>
<p>我地可以將一個 K8s pod 既某個 container 既 file system 裡面既檔案抄到本地 file system。</p>
<p>由 container 既 <code>/tmp</code> 抄到目前既 working directory，將檔案名改成 <code>myapp.jar</code>：</p>
<pre><code class="language-bash">kubectl cp &quot;&lt;pod name&gt;:/tmp/app.jar&quot; ./myapp.jar
</code></pre>
<p>由 container 既 <code>/tmp</code> 抄到 <code>C:/output</code>（Windows），將檔案名改成 <code>myapp.jar</code>：</p>
<pre><code class="language-bash">kubectl cp &quot;&lt;pod name&gt;:/tmp/app.jar&quot; /output/myapp.jar
</code></pre>
<p>抄 container 既 <code>/tmp</code> 成個 folder 既檔案到目前既 working directory：</p>
<pre><code class="language-bash">kubectl cp &lt;pod name&gt;:/tmp/folder ./
</code></pre>
<p>抄 container 既 <code>/tmp</code> 成個 folder 既檔案到 <code>C:/output</code>（Windows）：</p>
<pre><code class="language-bash">kubectl cp &lt;pod name&gt;:/tmp/folder /output
</code></pre>
<hr/>
<h2>3.17 將檔案抄入 K8s container</h2>
<p>我地可以將一啲檔案由本地 file system 抄入 K8s pod 既某個 container 既 file system 裡面。</p>
<p>由目前既 working directory 抄到 container 既 <code>/tmp</code>，將檔案名改成 <code>app.jar</code>：</p>
<pre><code class="language-bash">kubectl cp ./myapp.jar &lt;pod name&gt;:/tmp/app.jar
</code></pre>
<p>由 <code>C:/input</code>（Windows）抄到 container 既 <code>/tmp</code>，將檔案名改成 <code>app.jar</code>：</p>
<pre><code class="language-bash">kubectl cp /input/myapp.jar &lt;pod name&gt;:/tmp/app.jar
</code></pre>
<p>抄目前既 working directory 成個 folder 既檔案抄到 container 既 <code>/tmp</code>：</p>
<pre><code class="language-bash">kubectl cp ./ &lt;pod name&gt;:/tmp
</code></pre>
<p>抄 <code>C:/input</code>（Windows）成個 folder 既檔案抄到 container 既 <code>/tmp</code>（但 <code>/tmp</code> 裡面會多左個 <code>input</code> folder）：</p>
<pre><code class="language-bash">kubectl cp /input &lt;pod name&gt;:/tmp
</code></pre>
<p>之後我地可以 <code>kubectl exec -it</code> 入個 container，然後：</p>
<pre><code class="language-bash">mv /tmp/input/* /tmp
rmdir /tmp/input
</code></pre>
<hr/>
<h1>4 參考資料</h1>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/">Kubernetes 官方文檔 - Organizing Cluster Access Using kubeconfig Files</a></li>
<li><a href="https://kubernetes.io/docs/reference/kubectl/">Kubernetes 官方文檔 - Command line tool (kubectl)</a></li>
<li><a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands">Kubernetes 官方文檔 - kubectl commands</a></li>
<li><a href="https://www.bluematador.com/learn/kubectl-cheatsheet">Kubectl Command Cheatsheet</a></li>
<li><a href="https://kubernetes.io/docs/tasks/administer-cluster/migrating-from-dockershim/find-out-runtime-you-use/">Kubernetes 官方文檔 - Find Out What Container Runtime is Used on a Node</a></li>
</ul><hr/><div class="vstack gap-3"><div class="text-center container"><div class="justify-content-center g-3 row row-cols-md-3 row-cols-sm-2 row-cols-1"><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="tel:+85263301333"><div class="card-body"><div class="card-title h5"><i class="fa-solid fa-phone" style="color:#009688"></i></div><p class="text-muted card-text">6330 1333<!-- --> </p></div></a></div><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="mailto:michaelboyboy@gmail.com"><div class="card-body"><div class="card-title h5"><i class="fa-solid fa-envelope" style="color:#f44336"></i></div><p class="text-muted card-text">michaelboyboy@gmail.com<!-- --> </p></div></a></div><div class="col"><a target="_blank" rel="external nofollow noopener noreferrer" class="SiteFooter_contact-item__2JRRr card" href="https://www.linkedin.com/in/mickchung"><div class="card-body"><div class="card-title h5"><i class="fa-brands fa-linkedin" style="color:#2196f3"></i></div><p class="text-muted card-text">www.linkedin.com/in/mickchung<!-- --> </p></div></a></div></div></div></div></div><script src="/e2-next/_next/static/chunks/webpack-f088da4552bcc253.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[8287,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\n3:I[3339,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n4:I[1367,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\n5:I[5244,[],\"\"]\n6:I[3866,[],\"\"]\n7:I[4798,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n8:I[6121,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\n9:I[3667,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"default\"]\na:I[8407,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nb:I[8173,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"8974\",\"static/chunks/app/page-c8b940db14fac9a0.js\"],\"\"]\nc:I[3197,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nd:I[7933,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\ne:I[3800,[\"7829\",\"static/chunks/7829-b7b9eb1dbe0d40e4.js\",\"2153\",\"static/chunks/2153-45fd9844831c6348.js\",\"7177\",\"static/chunks/app/layout-ea91c2d128ec48c2.js\"],\"default\"]\nf:I[6213,[],\"OutletBoundary\"]\n11:I[6213,[],\"MetadataBoundary\"]\n13:I[6213,[],\"ViewportBoundary\"]\n15:I[4835,[],\"\"]\n:HL[\"/e2-next/_next/static/css/d3df112486f97f47.css\",\"style\"]\n:HL[\"/e2-next/_next/static/css/c3624a693ae5a0c4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"wfZ4FdS4ntgGvzjeKJhfw\",\"p\":\"/e2-next\",\"c\":[\"\",\"blog\",\"kubectl-basics\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[\"(2023-04)\",{\"children\":[\"kubectl-basics\",{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/e2-next/_next/static/css/d3df112486f97f47.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/e2-next/_next/static/css/c3624a693ae5a0c4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css\"}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"gap\":5,\"children\":[[\"$\",\"$L3\",null,{\"gap\":5,\"className\":\"text-center\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"code\",null,{\"className\":\"SiteHeader_name__cwQmL\",\"children\":\"Chung Cheuk Hang Michael\"}],[\"$\",\"code\",null,{\"className\":\"SiteHeader_title__CCfvI\",\"children\":\"Java Web Developer\"}]]}],[\"$\",\"$L4\",null,{}]]}],[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"hr\",null,{}],[\"$\",\"$L3\",null,{\"gap\":3,\"children\":[\"$\",\"$L7\",null,{\"className\":\"text-center\",\"children\":[\"$\",\"$L8\",null,{\"xs\":1,\"sm\":2,\"md\":3,\"className\":\"justify-content-center g-3\",\"children\":[[\"$\",\"$L9\",\"0\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"tel:+85263301333\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-solid fa-phone\",\"style\":{\"color\":\"#009688\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"6330 1333\",\" \"]}]]}]}]}],[\"$\",\"$L9\",\"1\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"mailto:michaelboyboy@gmail.com\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-solid fa-envelope\",\"style\":{\"color\":\"#f44336\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"michaelboyboy@gmail.com\",\" \"]}]]}]}]}],[\"$\",\"$L9\",\"2\",{\"children\":[\"$\",\"$La\",null,{\"as\":\"$b\",\"href\":\"https://www.linkedin.com/in/mickchung\",\"target\":\"_blank\",\"rel\":\"external nofollow noopener noreferrer\",\"className\":\"SiteFooter_contact-item__2JRRr\",\"children\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"i\",null,{\"className\":\"fa-brands fa-linkedin\",\"style\":{\"color\":\"#2196f3\"}}]}],[\"$\",\"$Le\",null,{\"className\":\"text-muted\",\"children\":[\"www.linkedin.com/in/mickchung\",\" \"]}]]}]}]}]]}]}]}]]}]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"(2023-04)\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"(2023-04)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"kubectl-basics\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"(2023-04)\",\"children\",\"kubectl-basics\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"h1\",null,{\"children\":\"1 kubectl 介紹\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"kubectl\"}],\" 係一個用黎操作雲端 K8s clusters 既 K8s 資源既一個 CLI 工具。\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"2 登入 K8s cluster\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"用之前需要先成功登入 K8s cluster，拎到 client certificate、client key、token 等等既 data，之後就可以操作佢上面既 K8s 資源。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"呢啲 data 儲存喺 \",[\"$\",\"code\",null,{\"children\":\"C:/Users/\u003cusername\u003e/.kube/config\"}],\" 裡面。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"我地可以登入多個 K8s clusters，然後喺佢地之間 switch 黎 switch 去。\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"2.1 本地開發環境：Docker Desktop\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"如果係喺本地開發環境，直接喺 Docker Desktop 度 enable Kubernetes 就唔洗額外登入。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"2.2 本地開發環境：Minikube\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"如果係喺本地開發環境，直接用 Minikube 就唔洗額外登入。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"2.3 登入 Azure Kubernetes Service（AKS）\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"如果係用 AKS，就要用 Azure CLI 登入：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"az login -u \u003cemail\u003e\\r\\naz aks get-credentials -n \u003ccluster name\u003e -g \u003cresource group\u003e --admin --overwrite-existing\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"3 kubectl 指令\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.1 切換 cluster\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl config use-context \u003ccontext name\u003e\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.2 查看目前 cluster\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"我地可以睇到已經登入左既 cluster、佢既 context name、目前既默認 namespace，以及目前既 cluster（打左星號 \",[\"$\",\"code\",null,{\"children\":\"*\"}],\"）：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl config get-contexts\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.3 切換默認 namespace\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl config set-context --current --namespace=\u003cnamespace\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"如果唔先切換去目標 namespace，而目標 namespace 同現時默認既 namespace 唔同既話，咁就要喺每個 \",[\"$\",\"code\",null,{\"children\":\"kubectl\"}],\" command 都用 \",[\"$\",\"code\",null,{\"children\":\"-n \u003cnamespace\u003e\"}],\" option 去指定目標 namespace。\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.4 列出所有 K8s 資源種類\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl api-resources -o wide\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.5 列出某種類既 K8s 資源\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get \u003cresource type\u003e\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.1 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"睇 pod name、幾多個 containers 已經 ready、status、create 左幾耐：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get pods\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.2 \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get deployments\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.3 \",[\"$\",\"code\",null,{\"children\":\"ReplicaSet\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get replicasets\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.4 \",[\"$\",\"code\",null,{\"children\":\"HorizontalPodAutoscaler\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get horizontalpodautoscalers\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.5 \",[\"$\",\"code\",null,{\"children\":\"AuthorizationPolicy\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get authorizationpolicys\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.6 \",[\"$\",\"code\",null,{\"children\":\"Service\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get services\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.7 \",[\"$\",\"code\",null,{\"children\":\"VirtualService\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get virtualservices\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.8 \",[\"$\",\"code\",null,{\"children\":\"DestinationRule\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get destinationrules\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.9 \",[\"$\",\"code\",null,{\"children\":\"ServiceAccount\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get serviceaccounts\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.10 \",[\"$\",\"code\",null,{\"children\":\"Event\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get events\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.5.11 \",[\"$\",\"code\",null,{\"children\":\"Node\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"睇 nodes 同埋佢地既 container runtime 版本（\",[\"$\",\"code\",null,{\"children\":\"containerd\"}],\" 或者 \",[\"$\",\"code\",null,{\"children\":\"docker\"}],\"）：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get nodes -o wide\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.6 檢視 K8s 資源內容\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"用 \",[\"$\",\"code\",null,{\"children\":\"get\"}],\" 列出某種類既所有 K8s 資源之後，我地會見到個別 K8s 資源既名，然後就可以呢啲名黎 reference 個別 K8s 資源。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"睇重要既 fields：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl describe \u003cresource type\u003e \u003cresource name\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"睇曬所有 fields：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl get \u003cresource type\u003e \u003cresource name\u003e -o yaml\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"比較常需要檢視既 K8s 資源有 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 以及 \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\"，因為：\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 既內容可以話畀我地知而家個 microservice 用咩參數黎運行，例如 Image ID、env、args、requests、limits，可以幫助我地 troubleshoot 問題。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\" 定義左 pod template，係生成 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 既範本，修改佢之後 rollout restart 或者 delete \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 就可以避免重新部署個 microservice。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.7 修改 K8s 資源內容\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl edit \u003cresource type\u003e \u003cresource name\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"執行之後，會自動彈出 Notepad，修改完之後喺 Notepad 度 save，之後退出 Notepad，就會見到返回修改完成既回應。\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.8 刪除 K8s 資源\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl delete \u003cresource type\u003e \u003cresource name\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 算係比較常需要刪除既 K8s 資源，因為：\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"為左加快開發，我地會想即時改變 microservice 既執行參數，但係因為 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 裡面既 microservice 已經運行緊，就咁修改 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 唔會起到作用，所以就要修改 \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\" 既 pod template，然後刪除運行緊既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\"，等 K8s 自動生成 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 黎滿足 \",[\"$\",\"code\",null,{\"children\":\"ReplicaSet\"}],\" 要求既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 數量。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":[\"3.9 查看 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 日誌\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl logs \u003cpod name\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Follow logs（佢會一直咁 stream logs 去我地個 console）：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl logs -f \u003cpod name\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"睇最後 \",[\"$\",\"code\",null,{\"children\":\"20\"}],\" 行 logs，並且繼續 follow：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl logs -f \u003cpod name\u003e --tail=20\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"儲存喺檔案度（視乎 K8s 會為 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" keep 幾多 logs，有上限）：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl logs \u003cpod name\u003e \u003e logs.txt\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.10 Port-forward\"}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.10.1 Port-forward \",[\"$\",\"code\",null,{\"children\":\"Pod\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"我地部署左一個 web microservice 上 K8s 之後，當個 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 成功運行緊，我地就可以試下佢既 HTTP API 功能。\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"其中一個方式就係直接訪問個 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\"，呢個時候就需要用到 \",[\"$\",\"code\",null,{\"children\":\"port-forward\"}],\"。\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl port-forward \u003cpod name\u003e \u003cport\u003e\\r\\nkubectl port-forward \u003cpod name\u003e \u003clocal port\u003e:\u003cremote port\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"例子一：假如個 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" expose 緊 \",[\"$\",\"code\",null,{\"children\":\"8080\"}],\"，而我地又想 local port 同 remote port 用埋同一個：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl port-forward \u003cpod name\u003e 8080\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"之後我地可以：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"curl localhost:8080\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"例子二：假如個 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" expose 緊 \",[\"$\",\"code\",null,{\"children\":\"8080\"}],\"，而我地又想 local port 用另一個，例如係 \",[\"$\",\"code\",null,{\"children\":\"8081\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl port-forward \u003cpod name\u003e 8081:8080\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"之後我地可以：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"curl localhost:8081\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.10.2 Port-forward \",[\"$\",\"code\",null,{\"children\":\"Service\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"同樣地，我地都可以 port-forward \",[\"$\",\"code\",null,{\"children\":\"Service\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl port-forward service/\u003cservice name\u003e \u003cport\u003e\\r\\nkubectl port-forward service/\u003cservice name\u003e \u003clocal port\u003e:\u003cremote port\u003e\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"children\":[\"3.10.3 Port-forward \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"同樣地，我地都可以 port-forward \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl port-forward deployment/\u003cdeployment name\u003e \u003cport\u003e\\r\\nkubectl port-forward deployment/\u003cdeployment name\u003e \u003clocal port\u003e:\u003cremote port\u003e\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":[\"3.11 Scale up/down \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"手動增加或者減少 \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\" 既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 數量：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl scale --replicas=\u003cnew replica count\u003e deployment \u003cdeployment name\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"註：如果有用緊 \",[\"$\",\"code\",null,{\"children\":\"HorizontalPodAutoscaler\"}],\"，因為佢會控制 replicas 既數量，所以手動 scale up、scale down 係唔會 work，除非我地完全 scale down 到 \",[\"$\",\"code\",null,{\"children\":\"0\"}],\" 或者刪除左個 \",[\"$\",\"code\",null,{\"children\":\"HorizontalPodAutoscaler\"}],\"。\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":[\"3.12 重新部署 \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"想重新部署 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 但唔想有 downtime 既話，可以 restart \",[\"$\",\"code\",null,{\"children\":\"Deployment\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl rollout restart deployment \u003cdeployment name\u003e\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"K8s 會逐一將而家相同數量既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 重新部署：\"]}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"先部署新既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\"。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"等新既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" ready（probes 成功）。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"移除舊既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\"。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"重複以上步驟直至新既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 取代曬所有舊既 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\"。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":[\"3.13 對 \",[\"$\",\"code\",null,{\"children\":\"Pod\"}],\" 裡面既 container 執行指令\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"有時如果需要檢視 container 裡面既檔案，或者執行一啲指令，都可以做到：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl exec -it -c \u003ccontainer\u003e \u003cpod name\u003e -- /bin/bash\\r\\nkubectl exec -it -c \u003ccontainer\u003e \u003cpod name\u003e -- sh\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"場景：\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"執行 \",[\"$\",\"code\",null,{\"children\":\"ls -l\"}],\" 以及 \",[\"$\",\"code\",null,{\"children\":\"cat \u003cfilename\u003e\"}],\" 去睇下有咩檔案，以及個別檔案內容。\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"執行 \",[\"$\",\"code\",null,{\"children\":\"java -version\"}],\" 去了解 Java microservice 既 Java 版本。\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.14 查看某種類 K8s 資源既資源使用情況\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"呢度既「資源使用情況」係指 CPU、memory、storage。\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl top \u003cresource type\u003e\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.15 部署 K8s 資源\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"根據檔案內容而部署或者更新 K8s resources：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl apply -f path/to/file.yml\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"根據檔案內容而刪除 K8s resources：\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl delete -f path/to/file.yml\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.16 從 K8s container 抄出檔案\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"我地可以將一個 K8s pod 既某個 container 既 file system 裡面既檔案抄到本地 file system。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"由 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\" 抄到目前既 working directory，將檔案名改成 \",[\"$\",\"code\",null,{\"children\":\"myapp.jar\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp \\\"\u003cpod name\u003e:/tmp/app.jar\\\" ./myapp.jar\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"由 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\" 抄到 \",[\"$\",\"code\",null,{\"children\":\"C:/output\"}],\"（Windows），將檔案名改成 \",[\"$\",\"code\",null,{\"children\":\"myapp.jar\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp \\\"\u003cpod name\u003e:/tmp/app.jar\\\" /output/myapp.jar\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"抄 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\" 成個 folder 既檔案到目前既 working directory：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp \u003cpod name\u003e:/tmp/folder ./\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"抄 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\" 成個 folder 既檔案到 \",[\"$\",\"code\",null,{\"children\":\"C:/output\"}],\"（Windows）：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp \u003cpod name\u003e:/tmp/folder /output\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"3.17 將檔案抄入 K8s container\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"我地可以將一啲檔案由本地 file system 抄入 K8s pod 既某個 container 既 file system 裡面。\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"由目前既 working directory 抄到 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\"，將檔案名改成 \",[\"$\",\"code\",null,{\"children\":\"app.jar\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp ./myapp.jar \u003cpod name\u003e:/tmp/app.jar\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"由 \",[\"$\",\"code\",null,{\"children\":\"C:/input\"}],\"（Windows）抄到 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\"，將檔案名改成 \",[\"$\",\"code\",null,{\"children\":\"app.jar\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp /input/myapp.jar \u003cpod name\u003e:/tmp/app.jar\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"抄目前既 working directory 成個 folder 既檔案抄到 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\"：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp ./ \u003cpod name\u003e:/tmp\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"抄 \",[\"$\",\"code\",null,{\"children\":\"C:/input\"}],\"（Windows）成個 folder 既檔案抄到 container 既 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\"（但 \",[\"$\",\"code\",null,{\"children\":\"/tmp\"}],\" 裡面會多左個 \",[\"$\",\"code\",null,{\"children\":\"input\"}],\" folder）：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"kubectl cp /input \u003cpod name\u003e:/tmp\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"之後我地可以 \",[\"$\",\"code\",null,{\"children\":\"kubectl exec -it\"}],\" 入個 container，然後：\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"mv /tmp/input/* /tmp\\r\\nrmdir /tmp/input\\n\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"4 參考資料\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/\",\"children\":\"Kubernetes 官方文檔 - Organizing Cluster Access Using kubeconfig Files\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://kubernetes.io/docs/reference/kubectl/\",\"children\":\"Kubernetes 官方文檔 - Command line tool (kubectl)\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands\",\"children\":\"Kubernetes 官方文檔 - kubectl commands\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.bluematador.com/learn/kubectl-cheatsheet\",\"children\":\"Kubectl Command Cheatsheet\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://kubernetes.io/docs/tasks/administer-cluster/migrating-from-dockershim/find-out-runtime-you-use/\",\"children\":\"Kubernetes 官方文檔 - Find Out What Container Runtime is Used on a Node\"}]}],\"\\n\"]}]],null,[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"wIjlTY3LyruOPQp5KWqHN\",{\"children\":[[\"$\",\"$L11\",null,{\"children\":\"$L12\"}],[\"$\",\"$L13\",null,{\"children\":\"$L14\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$15\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"14:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n12:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Michael Chung's e-Portfolio\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Powered by Next.js and React\"}]]\n"])</script><script>self.__next_f.push([1,"10:null\n"])</script></body></html>