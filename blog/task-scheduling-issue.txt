1:"$Sreact.fragment"
2:I[8287,["9967","static/chunks/9967-83c48e6c14f3f0b6.js","7177","static/chunks/app/layout-d379193696b953b0.js"],"default"]
3:I[3339,["8974","static/chunks/app/page-709d1dcf2418e267.js"],"default"]
4:I[1367,["9967","static/chunks/9967-83c48e6c14f3f0b6.js","7177","static/chunks/app/layout-d379193696b953b0.js"],"default"]
5:I[5244,[],""]
6:I[3866,[],""]
7:I[7868,["9967","static/chunks/9967-83c48e6c14f3f0b6.js","7177","static/chunks/app/layout-d379193696b953b0.js"],"default"]
8:I[4547,[],"ClientSegmentRoot"]
9:I[5211,["586","static/chunks/13b76428-e7d338032a603c0d.js","5359","static/chunks/5359-7a1bc9d752196327.js","8329","static/chunks/app/blog/(blogPosts)/layout-8d294fce928e4e37.js"],"default"]
b:I[6213,[],"OutletBoundary"]
d:I[6213,[],"MetadataBoundary"]
f:I[6213,[],"ViewportBoundary"]
11:I[4835,[],""]
:HL["/e2-next/_next/static/css/e7797664af107298.css","style"]
:HL["/e2-next/_next/static/css/d3df112486f97f47.css","style"]
:HL["/e2-next/_next/static/css/666038510c08556c.css","style"]
:HL["/e2-next/_next/static/css/c388c53a0b0c1807.css","style"]
:HL["/e2-next/_next/static/css/46f1c2d2deabcffa.css","style"]
0:{"P":null,"b":"5pXOh46WihjaKZ_GtO4Qz","p":"/e2-next","c":["","blog","task-scheduling-issue"],"i":false,"f":[[["",{"children":["blog",{"children":["(blogPosts)",{"children":["(2021-06)",{"children":["task-scheduling-issue",{"children":["__PAGE__",{}]}]}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/e2-next/_next/static/css/e7797664af107298.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/e2-next/_next/static/css/d3df112486f97f47.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","2",{"rel":"stylesheet","href":"/e2-next/_next/static/css/666038510c08556c.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"href":"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","rel":"stylesheet"}],["$","link",null,{"rel":"stylesheet","href":"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"}]]}],["$","body",null,{"children":["$","$L2",null,{"children":["$","$L3",null,{"gap":5,"children":[["$","$L3",null,{"gap":5,"className":"text-center","children":[["$","div",null,{"children":[["$","code",null,{"className":"SiteHeader_name__cwQmL","children":"Chung Cheuk Hang Michael"}],["$","code",null,{"className":"SiteHeader_title__CCfvI","children":"Java Web Developer"}]]}],["$","$L4",null,{}]]}],["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]]],"forbidden":"$undefined","unauthorized":"$undefined"}],["$","hr",null,{}],["$","$L7",null,{}]]}]}]}]]}]]}],{"children":["blog",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["(blogPosts)",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/e2-next/_next/static/css/c388c53a0b0c1807.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L8",null,{"Component":"$9","slots":{"children":["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","(blogPosts)","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]},"params":{},"promise":"$@a"}]]}],{"children":["(2021-06)",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","(blogPosts)","children","(2021-06)","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["task-scheduling-issue",["$","$1","c",{"children":[null,["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","(blogPosts)","children","(2021-06)","children","task-scheduling-issue","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":[[["$","a",null,{"href":"#1-背景","style":{"textDecoration":"none"},"children":["$","h1",null,{"id":"1-背景","className":"mdx-components_heading__HrNl3","style":{"zIndex":1000000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"1 背景"]}]}],"\n",["$","a",null,{"href":"#11-項目","style":{"textDecoration":"none"},"children":["$","h2",null,{"id":"11-項目","className":"mdx-components_heading__HrNl3","style":{"zIndex":1010000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"1.1 項目"]}]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"話說我寫呢篇文章果陣做緊既公司畀某昆蟲公司收購左之後，就要做大量 revamp 工作，亦包括滿足新既業務需求。眾多個系統當中，有一個負責定時定候 call Amazon、ebay 等等既平台既 back-end application，今年加入左 pull Amazon MWS data 既 task scheduling，主要為每一個商戶客既每一個店舖 pull Amazon MWS data。"}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["呢個項目要 call ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 個 Amazon MWS 既 API。"]}],"\n",["$","hr",null,{"className":"mdx-components_hr__o_oFr"}],"\n",["$","a",null,{"href":"#12-資料庫設計","style":{"textDecoration":"none"},"children":["$","h2",null,{"id":"12-資料庫設計","className":"mdx-components_heading__HrNl3","style":{"zIndex":1020000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"1.2 資料庫設計"]}]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"DB 設計上做左 partition，分庫分表（for horizontal scaling）："}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"Sharing rule：所有 DB tables 根據 user ID 既 value 做 sharding——某兩個位既數字會用黎對應 partition index"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["一共分成 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"100"}]," 個 partitions"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["所有 table 資料都由 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 個 physical DB、每個 physical DB 各自有 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 個 physical tables 組成（",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," DB 乘 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," tables = ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"100"}]," partitions）"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["例如：",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"db3"}]," 有 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"table1_30"}]," 至 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"table1_39"}]," 以及 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"table2_30"}]," 至 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"table2_39"}]]}],"\n"]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"Schema 既設計："}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["以 Amazon MWS API 黎分，有 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 個 logical tables，另外有其他 tables 負責 keep track 住 task scheduling"]}],"\n"]}],"\n",["$","hr",null,{"className":"mdx-components_hr__o_oFr"}],"\n",["$","a",null,{"href":"#13-task-scheduling-機制","style":{"textDecoration":"none"},"children":["$","h2",null,{"id":"13-task-scheduling-機制","className":"mdx-components_heading__HrNl3","style":{"zIndex":1030000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"1.3 Task scheduling 機制"]}]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"Task scheduling 既機制："}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"Scheduler server 會根據平台上面 scheduled job 既時間配置，定時定候 send message 去 cluster 裡面其中一機器"}],"\n"]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"而 cluster 裡面既每一部機器既系統設計係咁："}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"系統引入「三層分發」機制黎實現 distributed task scheduling"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["第一層：",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"split"}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"Cluster 裡面只會有一部機器收到 scheduler server 既指令"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["佢之後會做 split partitions 動作，將 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"100"}]," 個 partition indexes 派畀 cluster 裡面既所有機器"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"每部機器得到既果堆 partition indexes 可以係隨機"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["平均黎講每部機器會收到 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 個 partitions"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["例如：",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"instance3"}]," 收到 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"30"}]," 至 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"39"}]," 既 partition indexes"]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["第二層：",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"load"}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"當每部機器收到一堆 partition indexes，就會喺呢堆 partition indexes 指定既 physical DB 度 select task records"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["目前既設定 hardcode 左係只拎最新創建既 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"5"}]," 筆 task records"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"拎到 task records 之後就再派畀 cluster 裡面既所有機器"}],"\n"]}],"\n"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["第三層：",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"execute"}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"當每部機器收到 task record，就會加落 thread pool 度，等待處理"}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","hr",null,{"className":"mdx-components_hr__o_oFr"}],"\n",["$","a",null,{"href":"#14-production-場既配置","style":{"textDecoration":"none"},"children":["$","h2",null,{"id":"14-production-場既配置","className":"mdx-components_heading__HrNl3","style":{"zIndex":1040000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"1.4 Production 場既配置"]}]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["Production 場既 cluster 部署左 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 部機器。"]}],"\n",["$","hr",null,{"className":"mdx-components_hr__o_oFr"}],"\n",["$","a",null,{"href":"#15-任務配置","style":{"textDecoration":"none"},"children":["$","h2",null,{"id":"15-任務配置","className":"mdx-components_heading__HrNl3","style":{"zIndex":1050000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"1.5 任務配置"]}]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["呢個項目有 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"2"}]," 個任務："]}],"\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["創建 task","\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["每 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"1"}]," 分鐘執行一次"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"如果店舖既某個 Amazon MWS API 唔存在執行中既任務（例如已經執行完成），就會創建新 task，即係永無休止咁 pull data"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"每個 Amazon MWS API 都會有一個 task"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["每個 API 都係每隔 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 分鐘 call 一次"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["啲 API 分散喺唔同既分鐘（唔同既個位數），唔會同一分鐘做曬 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 個 API"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["例如：","\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":[["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"api-3"}]," 既執行時間係 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:03"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:13"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:23"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:33"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:43"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:53"}]]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":[["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"api-5"}]," 既執行時間係 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:05"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:15"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:25"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:35"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:45"}],"、",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"HH:55"}]]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"如此類推"}],"\n"]}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["處理 task","\n",["$","ul",null,{"className":"mdx-components_list__QQ4ZN","children":["\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["每 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"1"}]," 分鐘執行一次"]}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":"只要 task 到左預定執行時間，就會處理"}],"\n",["$","li",null,{"className":"mdx-components_list-item__fJ1NL","children":["目前既設定 hardcode 左係只拎最新創建既 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"5"}]," 筆 task records（每個 partition 都係咁）"]}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["Scheduler server 每分鐘都會 send messages 去負責 split 既機器度 trigger 呢 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"2"}]," 個 ",["$","em",null,{"children":"producer & consumer"}]," 既任務。"]}],"\n",["$","hr",null,{"className":"mdx-components_hr__o_oFr"}],"\n",["$","a",null,{"href":"#2-上線後出現既問題","style":{"textDecoration":"none"},"children":["$","h1",null,{"id":"2-上線後出現既問題","className":"mdx-components_heading__HrNl3","style":{"zIndex":2000000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"2 上線後出現既問題"]}]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"呢個 project 最近上左線，onboard 左一部分商戶既店舖 records，但就出現左一個都幾尷尬既問題。"}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"項目群組裡面有人話發現唔同既 Amazon MWS API 既 logical tables 出現既結果不一，某啲店舖喺某啲 tables 有 Amazon data records，但喺某啲 tables 就冇。"}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"查一查 logical DB，睇見啲 task records 既預定執行時間係幾日前，呢啲 task records 明明應該已經執行左但就唔知點解一直冇執行到。"}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"另外，有部分 tasks 執行失敗。"}],"\n",["$","hr",null,{"className":"mdx-components_hr__o_oFr"}],"\n",["$","a",null,{"href":"#3-原因分析","style":{"textDecoration":"none"},"children":["$","h1",null,{"id":"3-原因分析","className":"mdx-components_heading__HrNl3","style":{"zIndex":3000000},"children":[["$","i",null,{"className":"fa-solid fa-link mdx-components_heading-link__r6M6c"}],"3 原因分析"]}]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["Logical DB 裡面見到一堆應該已經執行但一直冇執行既 records 係黎自某幾個 partitions，而呢幾個 partitions 都有一個共通點，就係店舖數量大過 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"5"}],"。"]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":"呢個其實係一個數學既問題。"}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["首先，我地先假設 pull data 既 task 都可以喺 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"1"}]," 分鐘之內成功完成。跟住，我地要計下有問題既 partition 創建新 task 既速率。假如有問題既 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"partition-3"}]," 有 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"6"}]," 個店舖，而因為我地 call 每一款 Amazon API 都係每 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 分鐘 call 一次，我地有 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 個 API 要 call，咁即係每個 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"10"}]," 分鐘裡面都要執行 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"60"}]," 個 task records，而每到左下一分鐘都有 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"6"}]," 個 data tasks 到左預定執行時間而要被處理。"]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["正因為每分鐘，系統只會喺每個 partition 拎最新創建既 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"5"}]," 筆 task records，一黎呢個速率慢過有問題既 partitions 創建新 task 既速率，二黎因為只會拎最新創建既 task records，所以有啲舊既 task records（唔知點解會有）就一直沉底，永遠都唔輪到佢地被執行。"]}],"\n",["$","div",null,{"className":"mdx-components_paragraph__AUxxF","children":["理論上，假設所有店舖數據都可以平均咁分散喺各個 partition，咁呢個系統目前只係可以處理到 ",["$","code",null,{"className":"undefined mdx-components_normal-code__lOvs9","children":"500"}]," 個店舖（如果以用戶數量黎計就更少）。"]}]],[["$","link","0",{"rel":"stylesheet","href":"/e2-next/_next/static/css/46f1c2d2deabcffa.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$Lb",null,{"children":"$Lc"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","759kGTsEgRtd7SHeahW4k",{"children":[["$","$Ld",null,{"children":"$Le"}],["$","$Lf",null,{"children":"$L10"}],null]}]]}],false]],"m":"$undefined","G":["$11","$undefined"],"s":false,"S":true}
a:{}
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
e:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Blog posts"}],["$","meta","2",{"name":"description","content":"Powered by Next.js and React"}],["$","link","3",{"rel":"icon","href":"/e2-next/favicon.ico","type":"image/x-icon","sizes":"48x48"}]]
c:null
